<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PROJECT TITAN | CORE FINANCIAL [V4.2 - Layout Otimizado]</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* =================================== */
        /* 1. VARI√ÅVEIS CSS E BASE (FUTURE NOIR)*/
        /* =================================== */
        :root {
            /* Fundo Escuro Classudo */
            --cor-fundo-principal: #0E1117; 
            --cor-fundo-card: rgba(20, 25, 33, 0.9); /* Mais opaco para destaque */
            --cor-borda: #2C3540; 
            --cor-texto-principal: #F0F6FC; 
            --cor-texto-secundario: #8B949E; 
            
            /* Cores de Destaque Futuristas */
            --cor-sucesso: #10B981; /* Verde Esmeralda (Sucesso/Confirma√ß√£o) */
            --cor-divida: #EF4444; /* Vermelho Alerta */
            --cor-primario: #00BCD4; /* Azul Ciano Vibrante (A√ß√£o/Destaque) */
            --cor-meta-diaria: #9B59B6; /* Roxo Profundo */
            --cor-alerta: #F59E0B; /* Amarelo */
            --cor-fixa: #1DE9B6; /* Verde Neon para Fixas */
            --cor-fundo-ia: #151A23; /* Fundo mais escuro para IA */
            --cor-destaque-ia: #FFD700; /* Dourado para IA/Prioridade */

            /* Tipografia */
            --fonte-titulo: 'Inter', sans-serif;
            --fonte-corpo: 'Inter', sans-serif;
            --fonte-dados: 'Space Mono', monospace; 
            
            /* Efeitos */
            --sombra-card: 0 4px 20px rgba(0, 0, 0, 0.5), inset 0 0 0 1px var(--cor-borda);
            --sombra-card-hover: 0 6px 30px rgba(0, 0, 0, 0.7), inset 0 0 0 2px var(--cor-primario);
            --transicao-rapida: 0.3s ease-in-out;
            --espacamento-mobile: 15px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: var(--fonte-corpo);
        }

        body {
            background-color: var(--cor-fundo-principal);
            color: var(--cor-texto-principal);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-image: radial-gradient(circle at 50% 50%, rgba(0, 188, 212, 0.05), transparent 80%);
        }

        .container {
            max-width: 1300px; 
            margin: 40px auto;
            padding: 0 25px;
            width: 100%;
        }
        
        /* =================================== */
        /* 2. BANNER E T√çTULO (Ajustado) */
        /* =================================== */

        .dynamic-banner {
            width: 100%;
            background-color: #000000;
            color: var(--cor-fixa); 
            padding: 10px 0;
            text-align: right;
            border-bottom: 2px solid var(--cor-fixa);
            box-shadow: 0 5px 20px rgba(29, 233, 182, 0.3);
            overflow: hidden; 
            white-space: nowrap; 
        }
        
        .banner-text {
            font-family: var(--fonte-dados);
            font-size: 1.1em;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding-right: 30px;
            display: inline-block;
            white-space: nowrap; 
            animation: moveBanner 10s linear infinite; 
        }
        
        @keyframes moveBanner {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .header-content {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 0 25px;
             max-width: 1300px; 
             margin: 30px auto 0;
        }

        h1 {
            font-family: var(--fonte-titulo);
            color: var(--cor-texto-principal);
            font-weight: 800;
            font-size: 3em; 
            letter-spacing: 2px;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
        }
        
        /* Bot√µes de A√ß√£o Geral (Cadastro, Sair) */
        .btn-principal {
            background-color: var(--cor-primario);
            color: var(--cor-fundo-principal);
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            transition: all var(--transicao-rapida);
            white-space: nowrap;
        }
        .btn-principal:hover {
            background-color: #00A3B5;
            box-shadow: 0 0 8px rgba(0, 188, 212, 0.7);
        }
        
        /* Bot√£o de Sair (Melhor Localizado) */
        .btn-sair {
            background-color: var(--cor-divida);
            color: var(--cor-texto-principal);
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            transition: background-color var(--transicao-rapida);
        }
        .btn-sair:hover {
            background-color: #CC3333;
        }
        
        /* Bot√£o de Rastreio de Metas (DATA - Removida Descri√ß√£o) */
        #data-atual-info {
             text-align: center;
             margin-top: 15px;
             margin-bottom: 25px;
        }
        #btn-data-atual {
             background-color: var(--cor-meta-diaria);
             color: var(--cor-texto-principal);
             border: none;
             padding: 12px 25px;
             border-radius: 6px;
             cursor: pointer;
             font-weight: 700;
             font-family: var(--fonte-dados);
             font-size: 1.1em; /* Um pouco maior */
             transition: all var(--transicao-rapida);
             box-shadow: 0 2px 10px rgba(155, 89, 182, 0.5);
        }
        #btn-data-atual:hover {
             background-color: #A96EC2;
             box-shadow: 0 0 15px rgba(155, 89, 182, 0.8);
        }


        
        /* =================================== */
        /* 3. DASHBOARD E CART√ïES */
        /* =================================== */
        
        /* Target Di√°rio (Estilo Base) */
        .meta-diaria-total {
            text-align: center;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            background-color: var(--cor-fundo-card);
            box-shadow: var(--sombra-card);
            transition: all var(--transicao-rapida);
        }
        .meta-diaria-total > div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #meta-diaria-total-el {
            font-size: 2.5em; /* Maior destaque */
            font-weight: 800;
            color: var(--cor-meta-diaria);
            font-family: var(--fonte-dados);
            margin-top: 5px;
            line-height: 1.2;
        }
        .destaque-conclusao {
            font-size: 1em;
            font-weight: 700;
            margin-top: 15px;
            font-family: var(--fonte-titulo);
        }

        /* Efeito Glow para Meta Batida */
        .meta-batida {
            border: 3px solid var(--cor-sucesso) !important;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.7), 0 0 30px rgba(16, 185, 129, 0.5);
            background-color: rgba(16, 185, 129, 0.1) !important;
        }

        /* Barra de Progresso */
        .progresso-bar-container {
            height: 12px; /* Ligeiramente mais alta */
            background-color: #1A212E; 
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
            border: 1px solid var(--cor-borda);
        }

        .progresso {
            height: 100%;
            background: linear-gradient(90deg, #444444 0%, var(--cor-sucesso) 100%); 
            border-radius: 6px;
            transition: width 0.6s ease-out; 
        }

        .dashboard-header {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        .info-card {
            background-color: var(--cor-fundo-card);
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--sombra-card);
            border-left: 5px solid var(--cor-primario);
            transition: all var(--transicao-rapida);
        }
        .info-card:hover {
            box-shadow: var(--sombra-card-hover);
        }
        .info-card .rotulo {
            color: var(--cor-texto-secundario);
            font-size: 0.9em;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .info-card .valor {
            font-family: var(--fonte-dados);
            font-size: 1.8em;
            font-weight: 700;
            display: block;
        }
        .valor-caixa { color: var(--cor-sucesso); }
        .valor-divida { color: var(--cor-divida); }
        .progress-area {
            grid-column: span 3;
            background-color: var(--cor-fundo-card);
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--sombra-card);
            border-left: 5px solid var(--cor-sucesso);
        }

        
        /* =================================== */
        /* 4. SE√á√ïES E TOGGLES */
        /* =================================== */
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .section-header h2 {
            font-size: 1.5em;
            color: var(--cor-fixa);
        }

        .toggle-section {
            margin-top: 25px;
            border-radius: 8px;
            overflow: hidden;
        }
        .section-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            cursor: pointer;
            border-radius: 8px;
            transition: background-color var(--transicao-rapida);
            background-color: var(--cor-fundo-card);
            box-shadow: var(--sombra-card);
        }
        .section-toggle:hover {
            background-color: #1A212E;
        }
        .section-toggle h2 {
            font-size: 1.1em;
            margin: 0;
            color: var(--cor-texto-principal);
            font-weight: 600;
        }
        .section-toggle i {
            transition: transform 0.3s ease;
        }
        .section-toggle.aberto i {
            transform: rotate(180deg);
        }
        .toggle-section.receitas .section-toggle { border-left: 5px solid var(--cor-sucesso); }
        .toggle-section.fixas .section-toggle { border-left: 5px solid var(--cor-fixa); }
        .toggle-section.dividas .section-toggle { border-left: 5px solid var(--cor-divida); }

        .lista-container-ocultavel {
            padding-top: 15px;
            padding-bottom: 15px;
            background-color: var(--cor-fundo-card); /* Fundo sutil */
        }
        
        .alerta-nota {
             background-color: #1A212E;
             padding: 12px;
             border-radius: 6px;
             border-left: 5px solid var(--cor-alerta);
             color: var(--cor-alerta);
             font-size: 0.9em;
             margin: 15px 15px 15px 15px;
        }
        
        .motivacao-box {
            background-color: var(--cor-fundo-ia);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-style: italic;
            color: var(--cor-texto-secundario);
            margin-bottom: 25px;
            border: 1px solid var(--cor-borda);
        }

        
        /* =================================== */
        /* 5. TABELAS E BOT√ïES DE A√á√ÉO */
        /* =================================== */

        .tabela-wrapper {
             overflow-x: auto; 
             width: 100%;
             padding: 0 15px;
        }

        /* Estilo Base da Tabela (Compartilhado) */
        .tabela-transacoes-log, .tabela-fixas-log, .tabela-dividas-log {
             min-width: 400px; 
             width: 100%; 
             border-collapse: collapse;
             font-family: var(--fonte-dados);
             border: 1px solid var(--cor-borda);
             border-radius: 8px;
             overflow: hidden;
        }
        .tabela-transacoes-log th, .tabela-transacoes-log td,
        .tabela-fixas-log th, .tabela-fixas-log td,
        .tabela-dividas-log th, .tabela-dividas-log td {
            padding: 12px 8px; 
            text-align: left;
            border-bottom: 1px solid var(--cor-borda);
            background-color: #1A212E; /* Linhas escuras para contraste */
        }
        .tabela-transacoes-log th, .tabela-fixas-log th, .tabela-dividas-log th {
            background-color: #1A212E;
            color: var(--cor-primario);
            text-transform: uppercase;
            font-weight: 700;
            font-size: 0.9em;
            white-space: nowrap;
            background-color: #13171F; /* Fundo do cabe√ßalho mais escuro */
        }

        /* LOG DE RECEITAS: Cores Din√¢micas */
        .log-receita-descricao {
            color: var(--cor-sucesso); 
            font-weight: 600;
        }
        .log-receita-valor {
            color: var(--cor-sucesso) !important; 
            font-weight: 700;
        }
        .btn-acao-tabela {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            font-size: 1.1em;
            transition: color var(--transicao-rapida);
        }
        .btn-acao-tabela.deletar-log {
            color: var(--cor-divida); 
        }
        .btn-acao-tabela.deletar-log:hover {
            color: var(--cor-alerta);
        }

        /* BOT√ÉO DE A√á√ÉO DA TABELA FIXAS (PAGAR) */
        .btn-acao-tabela.pagar-fixa {
            background-color: var(--cor-fixa);
            color: var(--cor-fundo-principal);
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 700;
            transition: all var(--transicao-rapida);
            white-space: nowrap;
        }
        .btn-acao-tabela.pagar-fixa:hover {
            background-color: #00FFC6;
            box-shadow: 0 0 5px var(--cor-fixa);
        }
        /* Contas Fixas pagas (agora elas somem, mas se fosse para mostrar) */
        .conta-paga {
            display: none; /* Altera√ß√£o: fazer a linha desaparecer */
        }

        /* BOT√ÉO DE A√á√ÉO DA TABELA D√çVIDAS (QUITA√á√ÉO) */
        .btn-acao-tabela.quitar-divida {
             background-color: var(--cor-divida);
             color: var(--cor-fundo-principal);
             padding: 6px 10px;
             border: none;
             border-radius: 4px;
             cursor: pointer;
             font-size: 0.8em;
             font-weight: 700;
             transition: all var(--transicao-rapida);
             white-space: nowrap;
        }
        .btn-acao-tabela.quitar-divida.inativo {
             background-color: var(--cor-borda);
             cursor: not-allowed;
             opacity: 0.4;
        }
        .btn-acao-tabela.quitar-divida:hover:not(.inativo) {
             background-color: #FF7777;
        }
        
        /* =================================== */
        /* 6. MODAIS E M√ìDULO IA (Destaque Aprimorado) */
        /* =================================== */
        
        /* M√ìDULO IA */
        .plano-quitacao {
             background-color: var(--cor-fundo-ia);
             padding: 30px; /* Maior padding */
             border-radius: 10px;
             border: 2px solid var(--cor-destaque-ia);
             box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
             margin-top: 50px;
             transition: all var(--transicao-rapida);
        }
        .plano-quitacao:hover {
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
        }
        .plano-quitacao h3 {
             color: var(--cor-destaque-ia);
             margin-bottom: 25px;
             font-size: 1.6em; /* Mais destaque */
             display: flex;
             align-items: center;
             gap: 10px;
        }

        .ia-input-group {
             display: flex;
             gap: 20px;
             align-items: flex-end; /* Alinha o bot√£o com o input */
             margin-bottom: 25px;
        }
        .ia-input-group label {
            color: var(--cor-texto-principal);
            font-weight: 600;
            display: block;
            margin-bottom: 8px;
        }
        .ia-input-group input {
             padding: 10px;
             border-radius: 4px;
             border: 1px solid var(--cor-destaque-ia);
             background: #1A212E;
             color: var(--cor-fixa);
             font-family: var(--fonte-dados);
             width: 100px;
             text-align: center;
        }
        .ia-input-group button {
             padding: 10px 20px;
             background-color: var(--cor-destaque-ia);
             color: var(--cor-fundo-principal);
             font-weight: 700;
             border-radius: 4px;
             border: none;
             cursor: pointer;
             transition: all var(--transicao-rapida);
        }
        .ia-input-group button:hover {
             background-color: #FFEB80;
             box-shadow: 0 0 10px var(--cor-destaque-ia);
        }
        
        #resultado-plano-ia {
            background-color: #0E1117;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--cor-destaque-ia);
            margin-bottom: 25px;
            font-family: var(--fonte-dados);
        }
        #resultado-plano-ia p {
            margin: 8px 0;
            color: var(--cor-texto-principal);
        }
        #resultado-plano-ia strong {
            color: var(--cor-fixa);
        }
        
        #dicas-quitacao {
             padding: 15px;
             border-top: 1px dashed var(--cor-borda);
        }
        #dicas-quitacao h4 {
             color: var(--cor-primario);
             margin-bottom: 15px;
        }
        
        /* Modal de Relat√≥rio Di√°rio (NOVO) */
        .modal-relatorio-content {
            background-color: var(--cor-fundo-card);
            margin: 5% auto;
            padding: 30px;
            border-radius: 10px;
            border: 1px solid var(--cor-meta-diaria); 
            width: 90%;
            max-width: 800px;
            box-shadow: 0 0 20px rgba(155, 89, 182, 0.4);
        }
        .modal-relatorio-content h3 {
            color: var(--cor-meta-diaria);
            margin-bottom: 20px;
            font-size: 1.6em;
        }
        .tabela-relatorio {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-family: var(--fonte-dados);
        }
        .tabela-relatorio th, .tabela-relatorio td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid var(--cor-borda);
            font-size: 0.9em;
        }
        .tabela-relatorio th {
            background-color: #1A212E;
            color: var(--cor-meta-diaria);
            text-transform: uppercase;
        }
        .meta-batida-status {
            color: var(--cor-sucesso);
            font-weight: 700;
        }
        .meta-nao-batida-status {
            color: var(--cor-divida);
            font-weight: 700;
        }
        
        
        /* =================================== */
        /* 7. RESPONSIVIDADE (MOBILE FIRST) */
        /* =================================== */

        @media (max-width: 768px) {
            
            /* Global */
            .container {
                padding: 0 var(--espacamento-mobile);
            }
            .dashboard-header {
                 grid-template-columns: 1fr;
            }
            .progress-area {
                 grid-column: span 1;
            }
            
            /* T√≠tulo e Bot√£o Sair */
            .header-content {
                 flex-direction: column;
                 align-items: center;
                 margin-top: 20px;
            }
            .btn-sair {
                 margin-top: 15px;
                 margin-left: 0;
            }
            h1 {
                 font-size: 2em;
                 text-align: center;
            }
            
            /* Modal de Cadastro: Otimiza√ß√£o de Espa√ßo Vertical */
            .modal-content {
                 margin: 5% auto !important; 
                 padding: 20px !important; 
                 width: 90% !important; 
                 max-width: 90% !important;
            }
            
            /* Modal Relat√≥rio */
            .modal-relatorio-content {
                margin: 5% auto !important; 
                width: 95% !important; 
                padding: 15px !important;
            }
            .tabela-relatorio th, .tabela-relatorio td {
                 font-size: 0.75em;
            }
            
            /* Tabelas em Mobile: Redu√ß√£o de Padding e Fontes */
            .tabela-wrapper {
                 padding: 0 5px;
            }
            .tabela-transacoes-log, .tabela-fixas-log, .tabela-dividas-log {
                 font-size: 0.8em;
                 min-width: 100%;
            }
            .tabela-transacoes-log th, .tabela-transacoes-log td,
            .tabela-fixas-log th, .tabela-fixas-log td,
            .tabela-dividas-log th, .tabela-dividas-log td {
                padding: 8px 5px;
            }
            /* Ajuste de largura das colunas do LOG */
            .tabela-transacoes-log th:nth-child(1), .tabela-transacoes-log td:nth-child(1) { width: 50%; }
            .tabela-transacoes-log th:nth-child(2), .tabela-transacoes-log td:nth-child(2) { width: 30%; }
            .tabela-transacoes-log th:nth-child(3), .tabela-transacoes-log td:nth-child(3) { width: 20%; text-align: center; } 

            /* Ajuste de largura das colunas de Contas Fixas e D√≠vidas */
            .tabela-fixas-log th:nth-child(1), .tabela-fixas-log td:nth-child(1),
            .tabela-dividas-log th:nth-child(1), .tabela-dividas-log td:nth-child(1) { width: 45%; }
            .tabela-fixas-log th:nth-child(2), .tabela-fixas-log td:nth-child(2),
            .tabela-dividas-log th:nth-child(2), .tabela-dividas-log td:nth-child(2) { width: 35%; }
            .tabela-fixas-log th:nth-child(3), .tabela-fixas-log td:nth-child(3),
            .tabela-dividas-log th:nth-child(3), .tabela-dividas-log td:nth-child(3) { width: 20%; text-align: center; } 
            
            /* Plano IA */
            .plano-quitacao {
                 padding: 20px;
            }
            .ia-input-group {
                 flex-direction: column;
                 align-items: flex-start;
                 gap: 15px;
            }
            .ia-input-group > div {
                 width: 100%;
            }
            .ia-input-group input {
                 width: 100%;
            }
            .ia-input-group button {
                 width: 100% !important;
            }
        }
        
        /* Estilo para a tela de login */
        .login-box {
             background-color: var(--cor-fundo-card);
             padding: 40px;
             border-radius: 10px;
             box-shadow: var(--sombra-card);
             text-align: center;
             max-width: 350px;
             width: 90%;
        }
        #login-screen {
             display: flex;
             justify-content: center;
             align-items: center;
             height: 100vh;
             width: 100%;
             position: absolute;
             top: 0;
             left: 0;
             background-color: var(--cor-fundo-principal);
        }
        .login-box h2 {
             color: var(--cor-primario);
             margin-bottom: 10px;
             font-size: 1.8em;
        }
        .login-box label {
             display: block;
             text-align: left;
             margin-top: 20px;
             margin-bottom: 5px;
             color: var(--cor-texto-principal);
             font-weight: 600;
        }
        .login-box input {
             width: 100%;
             padding: 10px;
             border-radius: 5px;
             border: 1px solid var(--cor-borda);
             background-color: #1A212E;
             color: var(--cor-fixa);
             font-family: var(--fonte-dados);
        }
        .login-box button {
             margin-top: 25px;
        }
        
    </style>
</head>
<body>
    
    <div id="login-screen" style="display: none;">
        <div class="login-box">
            <h2><i class="fas fa-fingerprint"></i> PROJECT TITAN</h2>
            <p style="color: var(--cor-texto-secundario); margin-bottom: 25px;">Acesso restrito ao Painel de Gest√£o Estrat√©gica.</p>
            <label for="password-input">CHAVE DE SEGURAN√áA</label>
            <input type="password" id="password-input" placeholder="Chave de Acesso" required>
            <button id="btn-login" class="btn-principal"><i class="fas fa-sign-in-alt"></i> AUTORIZAR ACESSO</button>
            <p id="login-feedback" style="margin-top: 15px; color: var(--cor-divida); font-weight: bold;"></p>
        </div>
    </div>
    
    <div id="main-content" style="display: none;">
        
        <div class="dynamic-banner">
            <div class="banner-text" id="banner-text">
                üí∞ Foco & Disciplina. ZERO D√çVIDA. Capital √© PODER. üí∏
            </div>
        </div>
        
        <div class="header-content">
            <h1><i class="fas fa-terminal"></i> PROJECT TITAN</h1>
            <button class="btn-sair" id="btn-logout"><i class="fas fa-sign-out-alt"></i> SAIR</button>
        </div>

        
        <div class="container" id="data-atual-info">
            <button id="btn-data-atual" title="Clique para ver o Relat√≥rio de Metas">
                <i class="fas fa-calendar-day"></i> <span id="data-atual"></span>
            </button>
        </div>

        <div class="motivacao-box container" id="motivacao-diaria">
            <i class="fas fa-infinity"></i>
            "DISCIPLINA √â O COMANDO. A LIBERDADE FINANCEIRA √â O STATUS. Mantenha o Foco."
        </div>
        
        <div id="meta-diaria-card" class="meta-diaria-total container" style="border: 1px solid var(--cor-meta-diaria);">
            <div>
                <p style="color: var(--cor-texto-secundario); font-weight: 600;"><i class="fas fa-bullseye"></i> TARGET DI√ÅRIO DE APORTE (FIXAS + QUITA√á√ÉO)</p>
                <span id="meta-diaria-total-el">R$ 0,00</span>
            </div>
            <span id="meta-diaria-incentivo" class="destaque-conclusao" style="display: none;"></span>
        </div>
        

        <header class="dashboard-header container">
            
            <div class="info-card">
                <p class="rotulo"><i class="fas fa-satellite-dish"></i> CAPITAL ACUMULADO (ENTRADAS)</p>
                <span id="total-lancado" class="valor valor-caixa">R$ 0,00</span>
            </div>
            
            <div class="progress-area" id="meta-area">
                <p class="rotulo"><i class="fas fa-route"></i> STATUS DE QUITA√á√ÉO √öNICA</p>
                <p style="margin-bottom: 5px; color: var(--cor-texto-secundario);">D√≠vidas Pendentes: <span id="total-dividas-pendentes" style="font-weight: 700; color: var(--cor-divida); font-family: var(--fonte-dados);">R$ 0,00</span></p>
                <p>Progresso de Quita√ß√£o com Capital: <span id="progresso-capital-txt" style="font-weight: 700; color: var(--cor-sucesso); font-family: var(--fonte-dados);">0.00%</span></p>
                
                <div class="progresso-bar-container">
                    <div id="progresso-bar" class="progresso" style="width: 0%;"></div>
                </div>
            </div>
            
            <div class="info-card">
                <p class="rotulo"><i class="fas fa-skull-crossbones"></i> SALDO TOTAL A QUITAR</p>
                <span id="saldo-pendente-total" class="valor valor-divida">R$ 0,00</span>
            </div>
        </header>
        
        <main class="container">
            
            <div class="section-header">
                <h2><i class="fas fa-arrow-circle-up"></i> M√ìDULO: INJE√á√ÉO DE CAPITAL</h2>
                <button id="abrir-cadastro-receita" class="btn-principal"> <i class="fas fa-plus"></i> INJETAR VALOR</button>
            </div>

            
            <div id="historico-receitas-container" class="toggle-section">
                <div class="section-toggle receitas" id="toggle-receitas">
                    <h2><i class="fas fa-clipboard-list"></i> LOG: REGISTROS DE LAN√áAMENTO (CAPITAL)</h2>
                    <i class="fas fa-chevron-down"></i>
                </div>
                
                <div id="lista-receitas-container" class="lista-container-ocultavel" style="display: none;">
                    <div class="tabela-wrapper">
                        <table class="tabela-transacoes-log">
                            <thead>
                                <tr>
                                    <th>DESCRI√á√ÉO</th>
                                    <th>VALOR (R$)</th>
                                    <th>A√á√ÉO</th>
                                </tr>
                            </thead>
                            <tbody id="lista-entradas">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div id="feedback-fixas-quitadas" class="motivacao-box" style="display: none; margin-top: 40px; border: 2px solid var(--cor-sucesso);">
                 <i class="fas fa-medal" style="color: var(--cor-sucesso);"></i> PROTOCOLO DE CONTAS FIXAS CONCLU√çDO! <i class="fas fa-medal" style="color: var(--cor-sucesso);"></i>
                 <p style="color: var(--cor-texto-principal); font-weight: 600; font-style: normal; margin-top: 5px;">Contas Fixas liquidadas para este ciclo. Foco total em reduzir o Saldo Pendente.</p>
            </div>

            
            <div id="contas-fixas-toggle" class="toggle-section">
                <div class="section-toggle fixas" id="toggle-fixas">
                    <h2><i class="fas fa-calculator"></i> CONTAS FIXAS (META: R$ <span id="soma-fixas" class="valor-divida" style="font-family: var(--fonte-dados); font-size: 1em;">0,00</span>)</h2>
                    <i class="fas fa-chevron-down"></i>
                </div>
                
                <div id="lista-fixas-container" class="lista-container-ocultavel" style="display: none;">
                     <p class="alerta-nota">
                        <i class="fas fa-exclamation-triangle"></i> NOTA: Ao clicar em 'PAGAR', o valor ser√° deduzido imediatamente do Capital Acumulado.
                     </p>
                     <div class="tabela-wrapper">
                         <table class="tabela-fixas-log">
                             <thead>
                                 <tr>
                                     <th>CONTA</th>
                                     <th>VALOR (R$)</th>
                                     <th>A√á√ÉO</th>
                                 </tr>
                             </thead>
                             <tbody id="lista-contas-fixas-tabela">
                                 </tbody>
                         </table>
                    </div>
                </div>
            </div>


            
            <div id="dividas-container" class="toggle-section">
                <div class="section-toggle dividas" id="toggle-dividas">
                    <h2><i class="fas fa-radiation"></i> D√çVIDAS √öNICAS (PROTOCOLO DE REDU√á√ÉO)</h2>
                    <i class="fas fa-chevron-down"></i>
                </div>
                
                <div id="lista-dividas-quitar-container" class="lista-container-ocultavel" style="display: none;">
                    <p class="alerta-nota">
                        <i class="fas fa-exclamation-triangle"></i> NOTA: O bot√£o "QUITA√á√ÉO" s√≥ √© ativado quando o Capital Acumulado √© $\ge$ Saldo da D√≠vida.
                     </p>
                     <div class="tabela-wrapper">
                         <table class="tabela-dividas-log">
                             <thead>
                                 <tr>
                                     <th>CREDOR</th>
                                     <th>SALDO ATUAL (R$)</th>
                                     <th>A√á√ÉO</th>
                                 </tr>
                             </thead>
                             <tbody id="lista-dividas-quitar-tabela">
                                 </tbody>
                         </table>
                    </div>
                </div>
            </div>
            
            <div class="plano-quitacao" style="margin-top: 50px;">
                <h3><i class="fas fa-brain"></i> M√ìDULO IA: PLANO DE QUITA√á√ÉO ESTRAT√âGICO</h3>
                
                <div id="plano-ia-controls" class="ia-input-group">
                    <div>
                         <label for="meses-plano">TARGET: Meses para Quitar D√≠vidas √öNICAS</label>
                         <input type="number" id="meses-plano" value="5" min="1" max="60">
                    </div>
                    <button id="btn-gerar-plano" class="btn-principal" style="margin-top: 0;">
                        <i class="fas fa-redo-alt"></i> RECALCULAR PLANO
                    </button>
                </div>
                
                <div id="resultado-plano-ia">
                    <p style="color: var(--cor-texto-secundario);">Aguardando c√°lculo...</p>
                    </div>
                
                <div id="dicas-quitacao">
                     </div>
            </div>
            
        </main>
    </div>

    <div id="modal-relatorio" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7);">
        <div class="modal-relatorio-content">
            <span class="fechar-modal" id="fechar-modal-relatorio" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
            <h3><i class="fas fa-chart-line"></i> RELAT√ìRIO DE PROGRESSO DI√ÅRIO</h3>
            <p style="color: var(--cor-texto-secundario); font-size: 0.9em;">Hist√≥rico de metas di√°rias de aporte (Fixas + Quita√ß√£o) versus o capital efetivamente lan√ßado por dia.</p>
            
            <div class="tabela-wrapper" style="padding: 0;">
                <table class="tabela-relatorio">
                    <thead>
                        <tr>
                            <th>DATA</th>
                            <th>META TOTAL (R$)</th>
                            <th>APORTADO (R$)</th>
                            <th>STATUS</th>
                        </tr>
                    </thead>
                    <tbody id="corpo-tabela-relatorio">
                        </tbody>
                </table>
            </div>
            
        </div>
    </div>


    <div id="modal-receita" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7);">
        <div class="modal-content" style="background-color: var(--cor-fundo-card); margin: 15% auto; padding: 30px; border-radius: 10px; border: 1px solid var(--cor-primario); width: 80%; max-width: 400px; box-shadow: var(--sombra-card-hover);">
            <span class="fechar-modal" id="fechar-modal-receita" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
            <h3 id="titulo-dados-receita" style="color: var(--cor-sucesso);"><i class="fas fa-arrow-up"></i> LAN√áAMENTO DE CAPITAL</h3>
            <label for="valor-input-receita" style="display: block; margin-top: 20px; color: var(--cor-texto-principal); font-weight: 600;">VALOR DO APORTE (R$)</label>
            <input type="number" id="valor-input-receita" placeholder="0.00" min="0.01" step="0.01" style="width: 100%; padding: 10px; margin-top: 8px; border-radius: 5px; border: 1px solid var(--cor-borda); background-color: #1A212E; color: var(--cor-fixa); font-family: var(--fonte-dados);">
            <button class="btn-principal btn-ok" id="btn-cadastrar-receita" style="background-color: var(--cor-sucesso); margin-top: 25px;">CONFIRMAR LAN√áAMENTO <i class="fas fa-check"></i></button>
        </div>
    </div>
    
    <div id="modal-quitacao" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7);">
        <div class="modal-content" style="background-color: var(--cor-fundo-card); margin: 15% auto; padding: 30px; border-radius: 10px; border: 1px solid var(--cor-divida); width: 80%; max-width: 400px; box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);">
            <span class="fechar-modal" id="fechar-modal-quitacao" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
            <h3 id="titulo-quitacao" style="color: var(--cor-divida);"><i class="fas fa-receipt"></i> REGISTRAR PAGAMENTO</h3>
            <p style="margin-top: 15px; margin-bottom: 10px; font-family: var(--fonte-titulo); font-weight: 600; color: var(--cor-texto-secundario);">
                TARGET CREDOR: <span id="nome-credor" style="font-family: var(--fonte-dados); color: var(--cor-texto-principal);"></span>
            </p>
            <p style="margin-bottom: 20px; font-family: var(--fonte-titulo); font-weight: 600; color: var(--cor-texto-secundario);">
                SALDO PENDENTE: <span id="saldo-quitacao" class="saldo-divida" style="font-family: var(--fonte-dados);"></span>
            </p>
            <label for="valor-pagamento" style="display: block; margin-top: 20px; color: var(--cor-texto-principal); font-weight: 600;">VALOR DO PAGAMENTO (R$)</label>
            <input type="number" id="valor-pagamento" placeholder="0.00" min="0.01" step="0.01" style="width: 100%; padding: 10px; margin-top: 8px; border-radius: 5px; border: 1px solid var(--cor-borda); background-color: #1A212E; color: var(--cor-fixa); font-family: var(--fonte-dados);">
            <button class="btn-principal btn-ok" id="btn-quitar-divida" style="background-color: var(--cor-divida); margin-top: 25px;">FINALIZAR TRANSA√á√ÉO</button>
        </div>
    </div>
    
    <script>
        // ===========================================
        // JAVASCRIPT: L√ìGICA DE NEG√ìCIO E CONEX√ÉO V4.2
        // ===========================================

        const DIAS_UTEIS_MES = 22; 
        const LOGIN_PASSWORD = '01';
        const SESSION_TIMEOUT_MS = 600000; // 10 minutos
        let sessionTimer;

        // Dados Iniciais (Mantidos)
        const DEBT_LIST_INITIAL = [
             { id: 1, credor: "Itau visa", valorInicial: 200.00, valorAtual: 200.00 },
             { id: 2, credor: "Banco Inter", valorInicial: 120.00, valorAtual: 120.00 },
             { id: 3, credor: "Conect car", valorInicial: 60.00, valorAtual: 60.00 },
             { id: 4, credor: "Vivo", valorInicial: 95.00, valorAtual: 95.00 },
             { id: 5, credor: "Banco Pan", valorInicial: 265.00, valorAtual: 265.00 },
             { id: 6, credor: "Karen", valorInicial: 300.00, valorAtual: 300.00 },
             { id: 7, credor: "Claro", valorInicial: 300.00, valorAtual: 300.00 },
             { id: 8, credor: "Bruno Carro", valorInicial: 400.00, valorAtual: 400.00 },
             { id: 9, credor: "Mercado pago", valorInicial: 522.00, valorAtual: 522.00 },
             { id: 10, credor: "Koin", valorInicial: 700.00, valorAtual: 700.00 },
             { id: 11, credor: "Will bank", valorInicial: 700.00, valorAtual: 700.00 },
             { id: 12, credor: "Picpay", valorInicial: 859.64, valorAtual: 859.64 },
             { id: 13, credor: "Carol", valorInicial: 1000.00, valorAtual: 1000.00 },
             { id: 14, credor: "Localiza", valorInicial: 1200.00, valorAtual: 1200.00 },
             { id: 15, credor: "Light", valorInicial: 1450.00, valorAtual: 1450.00 },
             { id: 16, credor: "Casa", valorInicial: 1650.00, valorAtual: 1650.00 },
             { id: 17, credor: "Bradesco", valorInicial: 2000.00, valorAtual: 2000.00 },
             { id: 18, credor: "Itau master", valorInicial: 2500.00, valorAtual: 2500.00 },
             { id: 19, credor: "Carro", valorInicial: 3500.00, valorAtual: 3500.00 },
             { id: 20, credor: "Ravi", valorInicial: 4570.00, valorAtual: 4570.00 },
        ].sort((a, b) => a.valorAtual - b.valorAtual);
        
        const CONTAS_FIXAS_INITIAL = [
            { id: 100, nome: "Carro", valor: 1800.00, pago: false },
            { id: 101, nome: "Aluguel", valor: 850.00, pago: false },
            { id: 102, nome: "Academia", valor: 300.00, pago: false },
            { id: 103, nome: "Luz", valor: 250.00, pago: false },
            { id: 104, nome: "Internet Movel", valor: 120.00, pago: false },
            { id: 105, nome: "Wifi", valor: 100.00, pago: false }
        ].sort((a, b) => b.valor - a.valor);
        
        let idDebtQuitting = null; 
        
        // ===========================================
        // FUN√á√ïES UTILIT√ÅRIAS DE DADOS
        // ===========================================
        
        const formatarMoeda = (valor) => {
            return parseFloat(valor).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        };

        const getHojeString = () => new Date().toISOString().slice(0, 10);
        
        // --- Fun√ß√µes de Carregamento/Salvamento ---
        
        const carregarContasFixas = () => {
            const fixas = localStorage.getItem('contasFixas');
            if (!fixas) return CONTAS_FIXAS_INITIAL;
            
            const loadedFixas = JSON.parse(fixas);
            // Garante que o estado pago/n√£o pago est√° correto ao carregar
            const currentFixas = CONTAS_FIXAS_INITIAL.map(initialFixa => {
                const loadedFixa = loadedFixas.find(f => f.id === initialFixa.id);
                return { ...initialFixa, pago: loadedFixa ? loadedFixa.pago : false };
            }).sort((a, b) => b.valor - a.valor); // Mant√©m a ordem inicial
            
            return currentFixas;
        };
        
        const salvarContasFixas = (fixas) => localStorage.setItem('contasFixas', JSON.stringify(fixas));
        
        const carregarTransacoes = () => {
            const transacoes = localStorage.getItem('transacoes');
            return transacoes ? JSON.parse(transacoes) : [];
        };

        const salvarTransacoes = (transacoes) => localStorage.setItem('transacoes', JSON.stringify(transacoes));
        
        const carregarDividas = () => {
            const dividas = localStorage.getItem('dividas');
            if (!dividas) {
                salvarDividas(DEBT_LIST_INITIAL);
                return DEBT_LIST_INITIAL;
            }
            const loadedDebts = JSON.parse(dividas).map(d => ({ ...d, id: parseInt(d.id) }));
            loadedDebts.sort((a, b) => a.valorAtual - b.valorAtual);
            return loadedDebts;
        }
        
        const salvarDividas = (dividas) => {
             dividas.sort((a, b) => a.valorAtual - b.valorAtual);
             localStorage.setItem('dividas', JSON.stringify(dividas));
        }

        const getSomaFixas = (fixas) => fixas.filter(f => !f.pago).reduce((sum, item) => sum + item.valor, 0);
        const getMetaDiariaFixas = (somaFixas) => somaFixas / DIAS_UTEIS_MES;

        const getReceitasPorDia = (transacoes) => {
             const receitasDiarias = {};
             transacoes.filter(t => parseFloat(t.valor) > 0).forEach(t => { 
                 const data = t.data;
                 receitasDiarias[data] = (receitasDiarias[data] || 0) + parseFloat(t.valor);
             });
             return receitasDiarias;
        }
        
        const getTotais = (transacoes, dividas) => {
            let totalReceitas = transacoes.reduce((sum, t) => sum + parseFloat(t.valor), 0); 
            totalReceitas = Math.max(0, totalReceitas);

            const totalDividasIniciais = DEBT_LIST_INITIAL.reduce((sum, d) => sum + d.valorInicial, 0);
            const totalDividasPendentes = dividas.filter(d => d.valorAtual > 0.01).reduce((sum, d) => sum + parseFloat(d.valorAtual), 0);
            
            const totalPagoDividas = totalDividasIniciais - totalDividasPendentes;
            const progressoCapital = totalDividasIniciais > 0.01 
                ? (totalPagoDividas / totalDividasIniciais) * 100 
                : (totalDividasPendentes === 0 ? 100 : 0);
            
            const saldoPendenteTotal = totalDividasPendentes; 

            return { totalReceitas, totalDividasIniciais, totalDividasPendentes, progressoCapital, saldoPendenteTotal };
        }
        
        // --- Fun√ß√µes de Sess√£o e Seguran√ßa ---
        
        const resetSession = () => {
             localStorage.removeItem('loggedIn');
             document.getElementById('login-screen').style.display = 'flex';
             document.getElementById('main-content').style.display = 'none';
             if (sessionTimer) clearTimeout(sessionTimer);
             alert('Sess√£o expirada. Fa√ßa login novamente.');
        };
        
        const startSessionTimer = () => {
             if (sessionTimer) clearTimeout(sessionTimer);
             sessionTimer = setTimeout(resetSession, SESSION_TIMEOUT_MS);
        };
        
        // --- Bot√£o de Sair/Logout ---
        const resetTudoEVoltarLogin = () => {
             if (sessionTimer) clearTimeout(sessionTimer);
             localStorage.clear(); // LIMPA TUDO (incluindo fixas/d√≠vidas para reset)
             window.location.reload(); // Recarrega para iniciar limpo
        };


        // --- Fun√ß√µes de Contas Fixas ---
        
        const isHojePassouDiaQuinze = () => new Date().getDate() > 15;

        const checkAndResetContasFixas = () => {
            let fixas = carregarContasFixas();
            
            if (fixas.length === 0) {
                 // Caso inicial, se o localStorage estiver vazio
                 salvarContasFixas(CONTAS_FIXAS_INITIAL);
                 return CONTAS_FIXAS_INITIAL;
            }
            
            // Verifica se as fixas j√° foram resetadas este ciclo (reseta no dia 16)
            if (isHojePassouDiaQuinze() && localStorage.getItem('fixasResetadas') !== getHojeString()) {
                // Se sim, reseta para o estado inicial de "n√£o pago"
                fixas = CONTAS_FIXAS_INITIAL.map(fixa => ({...fixa, pago: false}));
                salvarContasFixas(fixas);
                localStorage.setItem('fixasResetadas', getHojeString());
            }
            return fixas;
        }

        const pagarContaFixa = (id) => {
            let fixas = carregarContasFixas();
            const transacoes = carregarTransacoes();
            const dividas = carregarDividas();
            
            const fixaIndex = fixas.findIndex(f => f.id === id);
            const fixa = fixas[fixaIndex];
            
            if (fixa && !fixa.pago) {
                const { totalReceitas } = getTotais(transacoes, dividas);
                if (totalReceitas >= fixa.valor) {
                    fixa.pago = true;
                    salvarContasFixas(fixas);
                    
                    // Deduz o valor da receita (cria uma transa√ß√£o negativa)
                    const novaTransacao = {
                        data: getHojeString(),
                        valor: (-fixa.valor).toFixed(2), 
                        descricao: `Pagamento de Conta Fixa: ${fixa.nome}`
                    };
                    transacoes.push(novaTransacao);
                    salvarTransacoes(transacoes);
                    
                    initDashboard(); // Atualiza tudo (e remove a linha da tabela)
                } else {
                    alert(`Capital insuficiente (${formatarMoeda(totalReceitas)}) para pagar ${fixa.nome} (${formatarMoeda(fixa.valor)})`);
                }
            }
        }
        
        const verificarEstadoContasFixas = (fixas) => {
            const todasPagas = fixas.every(f => f.pago);
            const feedbackEl = document.getElementById('feedback-fixas-quitadas');
            const toggleSection = document.getElementById('contas-fixas-toggle');
            
            if (todasPagas) {
                feedbackEl.style.display = 'block';
                toggleSection.style.display = 'none'; // Oculta a aba inteira
            } else {
                feedbackEl.style.display = 'none';
                toggleSection.style.display = 'block';
            }
        }

        // --- Fun√ß√µes de Transa√ß√£o ---
        
        const cadastrarReceita = () => {
            const valorInput = document.getElementById('valor-input-receita');
            const valor = parseFloat(valorInput.value);
            
            if (isNaN(valor) || valor <= 0) {
                 alert('Por favor, insira um valor positivo v√°lido.');
                 return;
            }
            
            const transacoes = carregarTransacoes();
            const novaTransacao = {
                data: getHojeString(),
                valor: valor.toFixed(2), 
                descricao: 'Saldo Adicionado (Receita)'
            };
            
            transacoes.push(novaTransacao);
            salvarTransacoes(transacoes);
            
            valorInput.value = '';
            document.getElementById('modal-receita').style.display = 'none';
            initDashboard();
        }

        const deletarTransacao = (index) => {
            let transacoes = carregarTransacoes();
            
            // Filtra e ordena transa√ß√µes de entrada para achar o √≠ndice real
            const transacoesEntrada = transacoes.filter(t => parseFloat(t.valor) > 0).map((t, i) => ({...t, displayIndex: i}));
            const transacoesOrdenadas = transacoesEntrada.sort((a, b) => new Date(b.data) - new Date(a.data));
            
            const transacaoToDelete = transacoesOrdenadas.find(t => t.displayIndex === index);
            
            if (transacaoToDelete) {
                // Remove a transa√ß√£o do array original
                const indexToRemove = transacoes.findIndex(t => t.data === transacaoToDelete.data && parseFloat(t.valor).toFixed(2) === parseFloat(transacaoToDelete.valor).toFixed(2));
                
                if (indexToRemove !== -1) {
                    transacoes.splice(indexToRemove, 1);
                    salvarTransacoes(transacoes);
                    initDashboard();
                }
            } else {
                 alert('Transa√ß√£o n√£o encontrada.');
            }
        }
        
        // --- Fun√ß√µes de Quita√ß√£o de D√≠vida ---

        const realizarPagamentoDivida = () => {
             const valorInput = document.getElementById('valor-pagamento');
             let valorPagamento = parseFloat(valorInput.value);
             
             if (isNaN(valorPagamento) || valorPagamento <= 0) {
                 alert('Por favor, insira um valor de pagamento positivo v√°lido.');
                 return;
             }
             
             let dividas = carregarDividas();
             let transacoes = carregarTransacoes();
             
             const dividaIndex = dividas.findIndex(d => d.id === idDebtQuitting);
             const divida = dividas[dividaIndex];
             
             if (!divida) {
                  alert('Erro: D√≠vida n√£o encontrada.');
                  return;
             }
             
             const { totalReceitas } = getTotais(transacoes, dividas);
             
             // O valor de pagamento n√£o pode exceder o Capital Acumulado ou o Saldo da D√≠vida
             valorPagamento = Math.min(valorPagamento, divida.valorAtual, totalReceitas);

             if (valorPagamento <= 0) {
                 alert('Capital acumulado ou saldo da d√≠vida insuficiente para o pagamento.');
                 return;
             }
             
             // 1. Atualiza a d√≠vida
             divida.valorAtual = divida.valorAtual - valorPagamento;
             divida.valorAtual = Math.max(0, divida.valorAtual); // Garante que n√£o fique negativo
             salvarDividas(dividas);

             // 2. Registra o d√©bito na transa√ß√£o
             const novaTransacao = {
                 data: getHojeString(),
                 valor: (-valorPagamento).toFixed(2), 
                 descricao: `Quita√ß√£o de D√≠vida: ${divida.credor}`
             };
             transacoes.push(novaTransacao);
             salvarTransacoes(transacoes);
             
             valorInput.value = '';
             document.getElementById('modal-quitacao').style.display = 'none';
             idDebtQuitting = null;
             initDashboard();
        }

        // ===========================================
        // L√ìGICA DE NEG√ìCIO: QUITA√á√ÉO E DASHBOARD
        // ===========================================

        const gerarPlanoQuitacaoIA = (isInit = false, totalDividasPendentes) => {
             const meses = parseInt(document.getElementById('meses-plano').value) || 5;
            
             if (totalDividasPendentes <= 0.01) {
                 if (!isInit) {
                      document.getElementById('resultado-plano-ia').innerHTML = '<p style="color: var(--cor-sucesso); font-weight: bold; margin-top: 15px;"><i class="fas fa-check-circle"></i> Protocolo de d√≠vida conclu√≠do. Foco em acumula√ß√£o de capital!</p>';
                 }
                 return 0;
             }

             const valorMensalNecessario = totalDividasPendentes / meses;
             const valorDiarioNecessario = valorMensalNecessario / DIAS_UTEIS_MES; 

             if (!isInit) {
                  const valorSemanalNecessario = valorDiarioNecessario * 5; 
                  let html = `
                     <p style="margin-bottom: 15px; color: var(--cor-texto-secundario); font-family: var(--fonte-titulo); font-weight: 600;">Para quitar **${formatarMoeda(totalDividasPendentes)}** em **${meses} meses**:</p>
                     <p><i class="fas fa-calendar-alt" style="color: var(--cor-destaque-ia);"></i> Aporte Mensal Necess√°rio: <strong>${formatarMoeda(valorMensalNecessario)}</strong></p>
                     <p><i class="fas fa-calendar-week" style="color: var(--cor-destaque-ia);"></i> Aporte Semanal (5 dias √∫teis): <strong>${formatarMoeda(valorSemanalNecessario)}</strong></p>
                     <p><i class="fas fa-sun" style="color: var(--cor-destaque-ia);"></i> Aporte Di√°rio (por dia √∫til): <strong>${formatarMoeda(valorDiarioNecessario)}</strong></p>
                  `;
                  document.getElementById('resultado-plano-ia').innerHTML = html;
             }
            
             return valorDiarioNecessario; 
         };

        const getMetaDiariaAtingida = (transacoes, totalDividasPendentes, fixas, dataAlvo = getHojeString()) => {
            const somaFixas = getSomaFixas(fixas);
            const metaDiariaFixas = getMetaDiariaFixas(somaFixas);
            
            const receitasDiarias = getReceitasPorDia(transacoes);
            
            const metaQuitacaoDiaria = gerarPlanoQuitacaoIA(true, totalDividasPendentes); 
            const metaTotalDiaria = metaDiariaFixas + metaQuitacaoDiaria;
            
            const recebido = receitasDiarias[dataAlvo] || 0;
            const faltando = Math.max(0, metaTotalDiaria - recebido);

            return {
                metaTotal: metaTotalDiaria,
                // Checagem de meta atingida (recebido >= meta, com margem de erro)
                atingido: recebido >= metaTotalDiaria - 0.009, 
                recebido: recebido,
                faltando: faltando
            };
        }
        
        const atualizarDashboard = (transacoes, dividas, fixas) => {
            const { totalReceitas, totalDividasPendentes, progressoCapital, saldoPendenteTotal } = getTotais(transacoes, dividas);
            const somaFixas = getSomaFixas(fixas);
            
            document.getElementById('data-atual').textContent = new Date().toLocaleDateString('pt-BR');
            document.getElementById('soma-fixas').textContent = formatarMoeda(somaFixas).replace('R$', '').trim(); 

            document.getElementById('total-lancado').textContent = formatarMoeda(totalReceitas); 
            document.getElementById('saldo-pendente-total').textContent = formatarMoeda(saldoPendenteTotal);
            document.getElementById('total-dividas-pendentes').textContent = formatarMoeda(totalDividasPendentes);
            
            const progressoExibido = Math.min(100, progressoCapital).toFixed(2);
            document.getElementById('progresso-capital-txt').textContent = `${progressoExibido}%`;
            
            document.getElementById('progresso-bar').style.width = `${progressoExibido}%`; 
            
            verificarEstadoContasFixas(fixas);
        };
        
        // ===========================================
        // FUN√á√ïES DE RENDERIZA√á√ÉO
        // ===========================================

        const renderizarContasFixas = (fixas) => {
            const container = document.getElementById('lista-contas-fixas-tabela');
            if (!container) return; 

            container.innerHTML = ''; 
            
            // Renderiza apenas as contas que AINDA N√ÉO FORAM PAGAS
            const fixasPendentes = fixas.filter(f => !f.pago);

            fixasPendentes.forEach((fixa) => {
                const isPago = fixa.pago; // Sempre falso aqui, mas mantido por seguran√ßa
                const btnClass = 'pagar-fixa';
                const btnText = 'PAGAR';
                
                const row = container.insertRow();
                row.id = `fixa-row-${fixa.id}`; // Adiciona ID para facilitar a remo√ß√£o
                
                row.innerHTML = `
                    <td><span style="color: var(--cor-texto-principal);">${fixa.nome}</span></td>
                    <td><span style="color: var(--cor-fixa); font-weight: 700;">${formatarMoeda(fixa.valor)}</span></td>
                    <td style="text-align: center;">
                        <button class="btn-acao-tabela ${btnClass}" data-id="${fixa.id}">
                            ${btnText}
                        </button>
                    </td>
                `;
            });
            
            if(fixasPendentes.length === 0) {
                 container.innerHTML = '<tr><td colspan="3" style="text-align: center; color: var(--cor-texto-secundario); opacity: 0.6;">Todas as contas fixas foram liquidadas neste ciclo.</td></tr>';
            }
        };


        const renderizarD√≠vidas = (dividas) => {
            const container = document.getElementById('lista-dividas-quitar-tabela');
            const { totalReceitas } = getTotais(carregarTransacoes(), dividas);
            
            if (!container) return;
            
            container.innerHTML = '';
            
            const dividasPendentes = dividas.filter(d => d.valorAtual > 0.01);
            
            if (dividasPendentes.length === 0) {
                container.innerHTML = '<tr><td colspan="3" style="text-align: center; color: var(--cor-sucesso); font-weight: bold;">Todas as d√≠vidas √∫nicas foram liquidadas!</td></tr>';
                return;
            }

            dividasPendentes.forEach((divida) => {
                const podeQuitar = totalReceitas >= divida.valorAtual - 0.009; // Margem para float
                const btnClass = podeQuitar ? 'quitar-divida' : 'quitar-divida inativo';
                const btnText = podeQuitar ? 'QUITA√á√ÉO' : 'APORTE NECESS√ÅRIO';
                
                const row = container.insertRow();
                row.innerHTML = `
                    <td><span style="color: var(--cor-texto-principal); font-weight: 600;">${divida.credor}</span></td>
                    <td><span style="color: var(--cor-divida); font-weight: 700;">${formatarMoeda(divida.valorAtual)}</span></td>
                    <td style="text-align: center;">
                        <button class="btn-acao-tabela ${btnClass}" data-id="${divida.id}" data-credor="${divida.credor}" data-valor="${divida.valorAtual}" ${!podeQuitar ? 'disabled' : ''}>
                            ${btnText}
                        </button>
                    </td>
                `;
            });
        };

        const renderizarLogReceitas = (transacoes) => {
            const listaEntradasBody = document.getElementById('lista-entradas');
            
            const transacoesEntrada = transacoes.filter(t => parseFloat(t.valor) > 0);
            // Mapeia e adiciona um displayIndex antes de ordenar para garantir que a exclus√£o use o √≠ndice correto do array filtrado
            const transacoesOrdenadas = transacoesEntrada.map((t, index) => ({...t, displayIndex: index}))
                                                        .sort((a, b) => new Date(b.data) - new Date(a.data));
            
            listaEntradasBody.innerHTML = '';
            if (transacoesOrdenadas.length === 0) {
                 listaEntradasBody.innerHTML = '<tr><td colspan="3" style="text-align: center; color: var(--cor-texto-secundario);">Nenhuma receita lan√ßada no log.</td></tr>';
            } else {
                transacoesOrdenadas.forEach((t) => {
                    const row = listaEntradasBody.insertRow();
                    row.innerHTML = `
                        <td><span class="log-receita-descricao">SALDO ADICIONADO</span></td>
                        <td class="log-receita-valor">${formatarMoeda(t.valor)}</td>
                        <td style="text-align: center;">
                            <button class="btn-acao-tabela deletar-log" data-index="${t.displayIndex}"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                });
            }
        };

        const renderizarTabelas = (transacoes, dividas, fixas) => {
             renderizarLogReceitas(transacoes);
             renderizarContasFixas(fixas);
             renderizarD√≠vidas(dividas);
        }

        const renderizarMetaDiaria = (transacoes, totalDividasPendentes, fixas) => {
             const { metaTotal, atingido, recebido, faltando } = getMetaDiariaAtingida(transacoes, totalDividasPendentes, fixas, getHojeString());
             
             const metaDiariaTotalEl = document.getElementById('meta-diaria-total-el');
             const metaDiariaCard = document.getElementById('meta-diaria-card');
             const metaDiariaIncentivoEl = document.getElementById('meta-diaria-incentivo');
            
             metaDiariaTotalEl.textContent = formatarMoeda(metaTotal);
             
             if (atingido) {
                 metaDiariaCard.classList.add('meta-batida');
                 metaDiariaTotalEl.style.color = 'var(--cor-sucesso)'; 
                 metaDiariaIncentivoEl.style.display = 'block';
                 
                 metaDiariaIncentivoEl.innerHTML = `
                     <i class="fas fa-medal"></i> **META DI√ÅRIA BATIDA!** <i class="fas fa-medal"></i>
                     <p style="color: var(--cor-fixa); font-size: 0.9em; margin-top: 5px; font-style: normal;">Capital Extra Acumulado: ${formatarMoeda(recebido - metaTotal)}</p>
                 `;
                 metaDiariaIncentivoEl.style.color = 'var(--cor-sucesso)';
             } else {
                 metaDiariaCard.classList.remove('meta-batida');
                 metaDiariaTotalEl.style.color = 'var(--cor-meta-diaria)';
                 metaDiariaCard.style.border = `1px solid var(--cor-meta-diaria)`; 
                 metaDiariaIncentivoEl.style.display = 'block';
                 
                 metaDiariaIncentivoEl.innerHTML = `
                     <i class="fas fa-exclamation-circle"></i> **FALTAM ${formatarMoeda(faltando)}** PARA BATER A META DI√ÅRIA.
                 `;
                 metaDiariaIncentivoEl.style.color = 'var(--cor-alerta)';
             }
        }
        
        const renderizarDicasQuitacao = (dividas) => {
             const div = document.getElementById('dicas-quitacao');
             const dividasPendentes = dividas.filter(d => d.valorAtual > 0.01);

             if (dividasPendentes.length === 0) {
                  div.innerHTML = '';
                  return;
             }
             
             let html = `
                 <h4><i class="fas fa-meteor"></i> ESTRAT√âGIA: BOLA DE NEVE (MENOR PARA MAIOR)</h4>
                 <p style="margin-bottom: 15px; color: var(--cor-texto-secundario); font-size: 0.9em;">
                    Priorize as **menores d√≠vidas** para criar impulso r√°pido no protocolo de quita√ß√£o.
                 </p>
             `;
             
             dividasPendentes.slice(0, 3).forEach((d, index) => {
                 html += `
                     <p style="font-family: var(--fonte-dados); margin-bottom: 5px;">
                         **PRIORIDADE ${index + 1}:** ${d.credor} (Saldo: <span style="color: var(--cor-divida);">${formatarMoeda(d.valorAtual)}</span>)
                     </p>
                 `;
             });
             
             html += `
                 <p style="margin-top: 15px; font-weight: 700; color: var(--cor-alerta);">
                     **A√ß√£o Estrat√©gica:** Direcione todo o excedente para a d√≠vida **PRIORIDADE 1**.
                 </p>
             `;
             
             div.innerHTML = html;
        }
        
        // --- Fun√ß√µes de Relat√≥rio Di√°rio (NOVO) ---

        const calcularRelatorioDiario = (transacoes, dividas, fixas) => {
            const receitasDiarias = getReceitasPorDia(transacoes);
            const todasAsDatas = Array.from(new Set(Object.keys(receitasDiarias)));
            
            const somaFixas = CONTAS_FIXAS_INITIAL.reduce((sum, item) => sum + item.valor, 0); // Usa a soma total para meta hist√≥rica
            const metaDiariaFixas = somaFixas / DIAS_UTEIS_MES;
            
            // Re-calcula a meta de quita√ß√£o di√°ria para a data atual, mas usa como base a hist√≥rica
            const totalDividasPendentes = dividas.filter(d => d.valorAtual > 0.01).reduce((sum, d) => sum + parseFloat(d.valorAtual), 0);
            const meses = parseInt(document.getElementById('meses-plano').value) || 5;
            const metaQuitacaoDiaria = (DEBT_LIST_INITIAL.reduce((s,d) => s + d.valorInicial, 0) / meses) / DIAS_UTEIS_MES; // Usa o valor total INICIAL
            
            const metaTotalDiaria = metaDiariaFixas + metaQuitacaoDiaria;

            const hoje = getHojeString();
            if (!todasAsDatas.includes(hoje)) {
                todasAsDatas.push(hoje);
            }
            
            todasAsDatas.sort((a, b) => new Date(b) - new Date(a));
            
            const relatorio = todasAsDatas.map(data => {
                const recebido = receitasDiarias[data] || 0;
                // Atingido √© checado contra a meta hist√≥rica total (fixas iniciais + quita√ß√£o inicial)
                const atingido = recebido >= metaTotalDiaria - 0.009;
                
                return {
                    data: data,
                    meta: metaTotalDiaria,
                    aportado: recebido,
                    atingido: atingido
                };
            });
            
            return relatorio;
        }

        const renderizarRelatorioDiario = (relatorio) => {
            const corpoTabela = document.getElementById('corpo-tabela-relatorio');
            corpoTabela.innerHTML = '';
            
            if (relatorio.length === 0) {
                corpoTabela.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--cor-texto-secundario);">Nenhum registro de meta di√°ria.</td></tr>';
                return;
            }

            relatorio.forEach(item => {
                const row = corpoTabela.insertRow();
                const statusClass = item.atingido ? 'meta-batida-status' : 'meta-nao-batida-status';
                const statusText = item.atingido ? '<i class="fas fa-check-circle"></i> BATIDA' : '<i class="fas fa-times-circle"></i> FALHOU';

                if (item.data === getHojeString()) {
                     row.style.backgroundColor = 'rgba(155, 89, 182, 0.1)';
                }

                row.innerHTML = `
                    <td>${new Date(item.data).toLocaleDateString('pt-BR')}</td>
                    <td style="color: var(--cor-meta-diaria);">${formatarMoeda(item.meta)}</td>
                    <td style="color: ${item.aportado > item.meta ? 'var(--cor-fixa)' : 'var(--cor-texto-principal)'}; font-weight: 700;">${formatarMoeda(item.aportado)}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                `;
            });
        }

        // ===========================================
        // FUN√á√ïES DE EVENTOS (LISTENERS)
        // ===========================================
        
        const abrirModalReceita = () => document.getElementById('modal-receita').style.display = 'block';
        const fecharModalReceita = () => document.getElementById('modal-receita').style.display = 'none';
        
        const abrirModalQuitacao = (credor, valor) => {
             document.getElementById('nome-credor').textContent = credor;
             document.getElementById('saldo-quitacao').textContent = formatarMoeda(valor);
             document.getElementById('valor-pagamento').value = valor.toFixed(2);
             document.getElementById('modal-quitacao').style.display = 'block';
        }
        const fecharModalQuitacao = () => document.getElementById('modal-quitacao').style.display = 'none';


        const initDashboard = () => {
            const transacoes = carregarTransacoes();
            const dividas = carregarDividas();
            
            const fixas = checkAndResetContasFixas(); 
            
            const { totalDividasPendentes } = getTotais(transacoes, dividas);
            
            atualizarDashboard(transacoes, dividas, fixas);
            renderizarTabelas(transacoes, dividas, fixas); 
            
            gerarPlanoQuitacaoIA(false, totalDividasPendentes); 
            renderizarMetaDiaria(transacoes, totalDividasPendentes, fixas);
            renderizarDicasQuitacao(dividas); 
        };
        
        // ===========================================
        // INICIALIZA√á√ÉO E EVENT LISTENERS
        // ===========================================
        
        document.addEventListener('DOMContentLoaded', () => {
             
             // --- Login e Sess√£o ---
             document.getElementById('btn-login').addEventListener('click', () => {
                 const password = document.getElementById('password-input').value;
                 const feedback = document.getElementById('login-feedback');
                 
                 if (password === LOGIN_PASSWORD) {
                     localStorage.setItem('loggedIn', 'true');
                     document.getElementById('login-screen').style.display = 'none';
                     document.getElementById('main-content').style.display = 'block';
                     startSessionTimer();
                     initDashboard();
                 } else {
                     feedback.textContent = 'ACESSO NEGADO: Chave incorreta.';
                 }
             });
             
             // --- Bot√£o de Sair ---
             document.getElementById('btn-logout').addEventListener('click', resetTudoEVoltarLogin);

             // --- Modals e Bot√µes de A√ß√£o ---
             document.getElementById('abrir-cadastro-receita').addEventListener('click', abrirModalReceita);
             document.getElementById('fechar-modal-receita').addEventListener('click', fecharModalReceita);
             document.getElementById('fechar-modal-quitacao').addEventListener('click', fecharModalQuitacao);
             
             document.getElementById('btn-cadastrar-receita').addEventListener('click', cadastrarReceita);
             document.getElementById('btn-quitar-divida').addEventListener('click', realizarPagamentoDivida);
             
             // --- Eventos do Relat√≥rio Di√°rio ---
             document.getElementById('btn-data-atual').addEventListener('click', () => {
                  const transacoes = carregarTransacoes();
                  const dividas = carregarDividas();
                  const fixas = carregarContasFixas();
                  const relatorio = calcularRelatorioDiario(transacoes, dividas, fixas);
                  renderizarRelatorioDiario(relatorio);
                  document.getElementById('modal-relatorio').style.display = 'block';
             });
             
             document.getElementById('fechar-modal-relatorio').addEventListener('click', () => {
                 document.getElementById('modal-relatorio').style.display = 'none';
             });
             
             // --- Toggles ---
             document.getElementById('toggle-receitas').addEventListener('click', (e) => {
                 const container = document.getElementById('lista-receitas-container');
                 if (container.style.display === 'none' || container.style.display === '') {
                     container.style.display = 'block';
                     e.currentTarget.classList.add('aberto');
                 } else {
                     container.style.display = 'none';
                     e.currentTarget.classList.remove('aberto');
                 }
             });
             document.getElementById('toggle-fixas').addEventListener('click', (e) => {
                 const container = document.getElementById('lista-fixas-container');
                 if (container.style.display === 'none' || container.style.display === '') {
                     container.style.display = 'block';
                     e.currentTarget.classList.add('aberto');
                 } else {
                     container.style.display = 'none';
                     e.currentTarget.classList.remove('aberto');
                 }
             });
             document.getElementById('toggle-dividas').addEventListener('click', (e) => {
                 const container = document.getElementById('lista-dividas-quitar-container');
                 if (container.style.display === 'none' || container.style.display === '') {
                     container.style.display = 'block';
                     e.currentTarget.classList.add('aberto');
                 } else {
                     container.style.display = 'none';
                     e.currentTarget.classList.remove('aberto');
                 }
             });
             
             // --- A√ß√µes de Tabela ---
             
             // Listener de LOG DE RECEITAS (Deletar)
             document.getElementById('lista-entradas').addEventListener('click', (e) => {
                 if (e.target.closest('.deletar-log')) {
                     const btn = e.target.closest('.deletar-log');
                     const index = btn.getAttribute('data-index');
                     deletarTransacao(parseInt(index));
                 }
             });

             // Listener de PAGAR CONTA FIXA
             document.getElementById('lista-contas-fixas-tabela').addEventListener('click', (e) => {
                  const button = e.target.closest('.pagar-fixa');
                  if (button && !button.disabled) {
                      const id = parseInt(button.getAttribute('data-id'));
                      pagarContaFixa(id);
                  }
             });

             // Listener de QUITAR D√çVIDA
             document.getElementById('lista-dividas-quitar-tabela').addEventListener('click', (e) => {
                  const button = e.target.closest('.quitar-divida');
                  if (button && !button.disabled) {
                      idDebtQuitting = parseInt(button.getAttribute('data-id'));
                      const credor = button.getAttribute('data-credor');
                      const valor = parseFloat(button.getAttribute('data-valor'));
                      abrirModalQuitacao(credor, valor);
                  }
             });
             
             // --- M√≥dulo IA ---
             document.getElementById('btn-gerar-plano').addEventListener('click', () => {
                  const dividas = carregarDividas();
                  const { totalDividasPendentes } = getTotais(carregarTransacoes(), dividas);
                  gerarPlanoQuitacaoIA(false, totalDividasPendentes);
                  renderizarDicasQuitacao(dividas);
                  // Atualiza a meta di√°ria ap√≥s recalcular o plano
                  const fixas = carregarContasFixas();
                  renderizarMetaDiaria(carregarTransacoes(), totalDividasPendentes, fixas);
             });

             // --- Inicializa√ß√£o da Tela ---
             if (localStorage.getItem('loggedIn') === 'true') {
                 document.getElementById('login-screen').style.display = 'none';
                 document.getElementById('main-content').style.display = 'block';
                 startSessionTimer(); 
                 initDashboard();
             } else {
                 document.getElementById('login-screen').style.display = 'flex';
                 const loginBox = document.querySelector('.login-box');
                 loginBox.style.border = `2px solid var(--cor-primario)`; 
                 loginBox.style.boxShadow = `var(--sombra-card-hover)`;
             }
        });
        

    </script>
</body>
</html>
