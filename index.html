<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocolo Financeiro | Painel de Gest√£o Estrat√©gica [V2.0]</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    

    <style>
        /* =================================== */
        /* 1. VARI√ÅVEIS CSS E BASE (FUTURE NOIR)*/
        /* =================================== */
        :root {
            /* Fundo Escuro Classudo */
            --cor-fundo-principal: #0E1117; 
            --cor-fundo-card: rgba(20, 25, 33, 0.7); /* Transparente/Glass */
            --cor-borda: #2C3540; /* Separadores/Bordas escuras */
            --cor-texto-principal: #F0F6FC; /* Texto Claro */
            --cor-texto-secundario: #8B949E; /* R√≥tulos/Secund√°rio */
            
            /* Cores de Destaque Futuristas */
            --cor-sucesso: #10B981; /* Verde Esmeralda */
            --cor-divida: #EF4444; /* Vermelho Alerta */
            --cor-primario: #00BCD4; /* Azul Ciano Vibrante */
            --cor-meta-diaria: #9B59B6; /* Roxo Profundo */
            --cor-alerta: #F59E0B; /* Amarelo */

            /* Tipografia */
            --fonte-titulo: 'Inter', sans-serif;
            --fonte-corpo: 'Inter', sans-serif;
            --fonte-dados: 'Space Mono', monospace; /* Para n√∫meros e valores */
            
            /* Efeitos */
            --sombra-card: 0 4px 20px rgba(0, 0, 0, 0.5), inset 0 0 0 1px var(--cor-borda);
            --sombra-card-hover: 0 6px 30px rgba(0, 0, 0, 0.7), inset 0 0 0 2px var(--cor-primario);
            --transicao-rapida: 0.3s ease-in-out;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: var(--fonte-corpo);
        }

        body {
            background-color: var(--cor-fundo-principal);
            color: var(--cor-texto-principal);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            /* Efeito de Vidro/Fosco no Fundo */
            background-image: radial-gradient(circle at 50% 50%, rgba(0, 188, 212, 0.1), transparent 80%);
        }

        .container {
            max-width: 1300px; /* Maior Largura */
            margin: 40px auto;
            padding: 0 25px;
            width: 100%;
        }
        
        h1 {
            font-family: var(--fonte-titulo);
            color: var(--cor-primario);
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
            font-size: 2.8em;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(0, 188, 212, 0.4);
        }

        h2 {
            font-family: var(--fonte-titulo);
            font-weight: 600;
            color: var(--cor-texto-principal);
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        /* Box de Mensagem Profissional (Minimalista) */
        .motivacao-box {
            background-color: var(--cor-fundo-card);
            color: var(--cor-texto-secundario);
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 35px;
            font-size: 1em;
            border: 1px solid var(--cor-borda);
            box-shadow: var(--sombra-card);
            backdrop-filter: blur(5px); /* Efeito Glass */
        }
        .motivacao-box i {
             color: var(--cor-primario);
             margin-right: 10px;
        }
        
        /* LOCALIZADOR DE DATA (Centralizado e HUD) */
        #data-atual-info {
            display: flex;
            justify-content: center; 
            margin-bottom: 30px;
        }
        #data-atual-info button {
            background-color: rgba(0, 188, 212, 0.1); 
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 1em;
            font-weight: 600;
            color: var(--cor-primario);
            border: 1px solid var(--cor-primario);
            cursor: pointer;
            transition: all var(--transicao-rapida);
            font-family: var(--fonte-dados);
            text-shadow: 0 0 5px rgba(0, 188, 212, 0.8);
        }
        #data-atual-info button:hover {
            background-color: rgba(0, 188, 212, 0.2);
            box-shadow: 0 0 15px rgba(0, 188, 212, 0.6);
        }

        /* =================================== */
        /* 2. CARD META DI√ÅRIA TOTAL (GRADIENTE)*/
        /* =================================== */
        .meta-diaria-total {
            background: linear-gradient(135deg, #1A212E, var(--cor-meta-diaria));
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(155, 89, 182, 0.5);
            transition: transform 0.3s, box-shadow 0.3s;
            border: 2px solid var(--cor-meta-diaria);
        }
        .meta-diaria-total:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(155, 89, 182, 0.7);
        }
        
        /* Estilo para Meta Di√°ria Conclu√≠da (Esmeralda) */
        .meta-diaria-concluida {
            background: linear-gradient(135deg, #0D3E35, var(--cor-sucesso));
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
            border: 2px solid var(--cor-sucesso);
        }

        .meta-diaria-total p {
            font-size: 1.1em;
            font-weight: 600;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: rgba(255, 255, 255, 0.8);
            font-family: var(--fonte-titulo);
        }
        .meta-diaria-total span {
            font-size: 4em;
            font-weight: 700;
            display: block;
            margin-top: 10px;
            font-family: var(--fonte-dados);
            line-height: 1.1;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .meta-diaria-total .destaque-conclusao {
            display: block;
            font-size: 1.5em;
            font-weight: 700;
            margin-top: 20px;
            color: #E0F7FA;
            font-family: var(--fonte-titulo);
        }


        /* =================================== */
        /* 3. DASHBOARD HEADER (CARDS)         */
        /* =================================== */

        .dashboard-header {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 30px;
            margin-bottom: 50px;
        }
        
        .info-card, .progress-area {
            background-color: var(--cor-fundo-card);
            padding: 35px;
            border-radius: 12px;
            box-shadow: var(--sombra-card);
            transition: all var(--transicao-rapida);
            backdrop-filter: blur(5px);
            border: 1px solid var(--cor-borda);
        }
        .info-card:hover, .progress-area:hover {
            box-shadow: var(--sombra-card-hover);
            border-color: var(--cor-primario);
        }
        
        .rotulo {
            font-size: 1em;
            color: var(--cor-texto-secundario);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            font-family: var(--fonte-titulo);
            font-weight: 600;
        }
        
        .rotulo i {
            margin-right: 12px;
            color: var(--cor-primario);
            font-size: 1.2em;
        }

        .valor {
            font-size: 3em;
            font-weight: 700;
            font-family: var(--fonte-dados);
            line-height: 1;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
        }

        .valor-caixa {
            color: var(--cor-sucesso);
        }

        .valor-divida {
            color: var(--cor-divida);
        }
        
        /* Progress Area */
        .progress-area p {
            font-size: 1em;
            margin-bottom: 8px;
            color: var(--cor-texto-principal);
        }
        .progresso-bar-container {
            width: 100%;
            height: 12px;
            background-color: #1A212E;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 25px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
        }
        .progresso {
            height: 100%;
            background: linear-gradient(90deg, #00BCD4, var(--cor-sucesso)); 
            border-radius: 6px;
            transition: width 0.8s ease-in-out;
            box-shadow: 0 0 10px var(--cor-sucesso);
        }
        
        /* =================================== */
        /* 4. BOT√ïES E SE√á√ïES GERAIS           */
        /* =================================== */

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--cor-borda);
            padding-bottom: 20px;
        }
        
        .btn-principal {
            background: var(--cor-primario);
            color: var(--cor-fundo-principal);
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 700;
            transition: all var(--transicao-rapida);
            text-transform: uppercase;
            box-shadow: 0 5px 15px rgba(0, 188, 212, 0.4);
            font-family: var(--fonte-titulo);
            letter-spacing: 0.5px;
        }

        .btn-principal:hover {
            background: #1DE9B6; /* Verde Neon */
            color: var(--cor-fundo-principal);
            box-shadow: 0 8px 20px rgba(29, 233, 182, 0.6);
            transform: translateY(-2px);
        }

        /* Estilos de Tabela Otimizados (High Contrast) */
        .tabela-transacoes {
            width: 100%;
            border-collapse: collapse; 
            font-size: 1em;
        }

        .tabela-transacoes th, .tabela-transacoes td {
            padding: 18px 15px;
            text-align: left;
            border-bottom: 1px solid var(--cor-borda);
            font-family: var(--fonte-dados);
        }
        
        .tabela-transacoes th {
            font-weight: 600;
            font-size: 0.85em;
            color: var(--cor-texto-secundario);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-family: var(--fonte-titulo);
            background-color: #1A212E; /* Linha de cabe√ßalho sutil */
        }

        .tabela-transacoes tbody tr:hover {
            background-color: #1A212E;
        }

        .btn-acao-tabela {
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all var(--transicao-rapida);
        }
        
        .btn-acao-tabela.quitar {
            background-color: var(--cor-sucesso);
            color: var(--cor-fundo-principal);
        }
        .btn-acao-tabela.quitar:hover {
            background-color: #059669;
            box-shadow: 0 0 10px var(--cor-sucesso);
        }

        .btn-acao-tabela.deletar {
            background-color: var(--cor-borda);
            color: var(--cor-texto-principal);
        }
        .btn-acao-tabela.deletar:hover {
            background-color: #4B5563;
            color: white;
        }

        .saldo-divida {
            font-weight: bold;
            color: var(--cor-divida);
        }
        
        /* SE√á√ÉO OCULT√ÅVEL (Geral) - Glass */
        .toggle-section {
            border: 1px solid var(--cor-borda);
            border-radius: 12px;
            margin-top: 40px;
            box-shadow: var(--sombra-card);
            background-color: var(--cor-fundo-card);
            backdrop-filter: blur(5px);
        }
        
        .section-toggle {
            background-color: rgba(26, 33, 46, 0.9); 
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            border-radius: 12px;
            transition: all var(--transicao-rapida);
            border-bottom: 1px solid var(--cor-borda);
        }
        .section-toggle:hover {
            background-color: #1A212E;
        }
        .section-toggle h2 {
            margin: 0;
            font-size: 1.5em;
            font-family: var(--fonte-titulo);
        }
        .section-toggle.dividas h2 {
            color: var(--cor-divida);
        }
        .section-toggle.receitas h2 {
            color: var(--cor-sucesso);
        }
        .section-toggle i {
            transition: transform 0.3s;
            color: var(--cor-texto-secundario);
        }
        .section-toggle.aberto i {
            transform: rotate(180deg);
            color: var(--cor-primario);
        }

        /* Conte√∫do Ocult√°vel */
        .lista-container-ocultavel {
            padding: 25px;
        }
        
        /* 5. Contas Fixas e Plano IA */
        .contas-fixas-container, .plano-quitacao {
             background-color: var(--cor-fundo-card);
             padding: 35px;
             border-radius: 12px;
             margin-top: 40px;
             border: 1px solid var(--cor-borda);
             box-shadow: var(--sombra-card);
             backdrop-filter: blur(5px);
        }
        
        /* FEEDBACK DE QUITA√á√ÉO DAS FIXAS (Dourado/Gold) */
        #feedback-fixas-quitadas {
             background: linear-gradient(90deg, #FFD700, #DAA520);
             text-align: center;
             color: var(--cor-fundo-principal);
             font-family: var(--fonte-titulo);
             font-size: 1.4em;
             font-weight: 800;
             padding: 30px;
             border-radius: 10px;
             box-shadow: 0 4px 15px rgba(255, 215, 0, 0.6);
             margin-top: 40px;
        }
        #feedback-fixas-quitadas p {
             margin-top: 10px;
             font-size: 1em;
             font-family: var(--fonte-corpo);
             font-weight: 500;
        }


        .contas-fixas-container h3, .plano-quitacao h3 {
             color: var(--cor-meta-diaria);
             font-weight: 700;
             margin-bottom: 25px;
             border-bottom: 1px solid var(--cor-borda);
             padding-bottom: 10px;
             font-family: var(--fonte-titulo);
             text-transform: uppercase;
             font-size: 1.3em;
             letter-spacing: 1px;
        }
        .contas-fixas-container ul {
            list-style: none;
            padding-left: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .contas-fixas-container li {
            background-color: #1A212E;
            padding: 18px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid var(--cor-meta-diaria);
            font-size: 1em;
            font-family: var(--fonte-dados);
        }
        
        .diaria-fixa-destaque {
            background-color: var(--cor-meta-diaria);
            color: white !important;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 4px;
        }
        
        /* Estilos de inputs (High-Tech) */
        input[type="number"], input[type="text"], input[type="date"], input[type="password"] {
            width: 100%;
            padding: 14px;
            margin-bottom: 18px;
            border: 1px solid var(--cor-borda);
            background-color: #1A212E;
            color: var(--cor-texto-principal);
            border-radius: 6px;
            font-size: 1em;
            transition: border-color var(--transicao-rapida), box-shadow var(--transicao-rapida);
            font-family: var(--fonte-dados);
        }
        input:focus {
            border-color: var(--cor-primario);
            outline: none;
            box-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
            background-color: #1A212E;
        }
        
        /* Plano IA Layout */
        #plano-ia-controls {
             display: flex; 
             align-items: center; 
             gap: 20px; 
             margin-bottom: 30px;
             flex-wrap: wrap; 
             border: 1px dashed var(--cor-primario);
             padding: 20px;
             border-radius: 8px;
             background-color: rgba(0, 188, 212, 0.05);
        }
        #meses-plano {
             width: 150px; 
             margin-bottom: 0;
             text-align: center;
        }
        #btn-gerar-plano {
            background: linear-gradient(45deg, var(--cor-alerta), #FFC107) !important;
            color: var(--cor-fundo-principal) !important;
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }
        #btn-gerar-plano:hover {
            background: linear-gradient(45deg, #FFC107, #FF9800) !important;
        }
        
        #resultado-plano-ia strong {
             color: var(--cor-primario);
             font-family: var(--fonte-dados);
             font-size: 1.1em;
             margin-left: 10px;
        }
        #resultado-plano-ia p {
             padding: 8px 0;
        }
        
        /* Dicas de Quita√ß√£o (Alerta Vermelho Fosco) */
        #dicas-quitacao {
             background-color: rgba(239, 68, 68, 0.1);
             padding: 25px;
             border-radius: 10px;
             margin-top: 30px;
             border: 1px solid var(--cor-divida);
             box-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
        }
        #dicas-quitacao h4 {
             color: var(--cor-divida);
             margin-bottom: 15px;
             font-weight: 700;
             border-bottom: 1px solid var(--cor-divida);
             padding-bottom: 10px;
             font-family: var(--fonte-titulo);
             text-transform: uppercase;
             font-size: 1.2em;
        }
        #dicas-quitacao ul {
             list-style: none;
             padding-left: 0;
        }
        #dicas-quitacao li {
             margin-bottom: 10px;
             font-size: 1em;
             padding: 8px 0;
             border-left: 4px solid var(--cor-alerta);
             padding-left: 15px;
             background-color: #1A212E;
             border-radius: 4px;
        }
        
        /* Estiliza√ß√£o para o filtro de receitas (HUD) */
        #filtro-receitas-batidas {
             display: flex;
             align-items: center;
             gap: 15px;
             margin-bottom: 25px;
             padding: 15px;
             border: 1px solid var(--cor-borda);
             border-radius: 8px;
             background-color: #1A212E;
        }
        #filtro-receitas-batidas button {
             padding: 10px 18px;
             background-color: var(--cor-primario);
             color: var(--cor-fundo-principal);
             border: none;
             border-radius: 6px;
             cursor: pointer;
             font-weight: 600;
             transition: all 0.2s;
             box-shadow: 0 2px 5px rgba(0, 188, 212, 0.4);
        }
        #filtro-receitas-batidas button:hover {
             background-color: #1DE9B6; 
        }

        /* Bot√£o Filtro Ativo */
        #filtro-receitas-batidas button.ativo {
             background-color: var(--cor-sucesso);
             color: var(--cor-fundo-principal);
             box-shadow: 0 0 10px var(--cor-sucesso);
        }
        
        /* =================================== */
        /* 6. MODAIS (High Contrast)           */
        /* =================================== */

        .modal {
            display: none; 
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8); 
            backdrop-filter: blur(10px); /* Blur Acentuado */
        }

        .modal-content {
            background-color: #1A212E;
            margin: 8% auto; 
            padding: 40px;
            width: 90%;
            max-width: 550px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), inset 0 0 0 1px var(--cor-borda);
            position: relative;
            border-top: 5px solid var(--cor-primario);
        }
        
        .modal-content h3 {
             font-family: var(--fonte-titulo);
             color: var(--cor-primario);
             margin-bottom: 25px;
             border-bottom: 1px solid var(--cor-borda);
             padding-bottom: 10px;
             font-size: 1.8em;
             font-weight: 700;
        }

        .fechar-modal {
            color: var(--cor-texto-secundario);
            position: absolute;
            top: 15px;
            right: 25px;
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            transition: color var(--transicao-rapida);
        }

        .fechar-modal:hover {
            color: var(--cor-divida);
        }
        
        .modal-content label {
             display: block;
             margin-bottom: 8px;
             color: var(--cor-texto-secundario);
             font-weight: 600;
             text-transform: uppercase;
             font-size: 0.9em;
             font-family: var(--fonte-titulo);
             letter-spacing: 1px;
        }
        
        .btn-ok {
            background-color: var(--cor-sucesso);
            color: var(--cor-fundo-principal);
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            float: right;
            margin-top: 25px;
            box-shadow: 0 4px 10px rgba(16, 185, 129, 0.5);
            transition: all var(--transicao-rapida);
            font-family: var(--fonte-titulo);
        }
        .btn-ok:hover {
            background-color: #059669;
            transform: translateY(-2px);
        }
        
        /* Modal de Rastreio de Metas */
        #modal-rastreio-metas .modal-content {
            border-top: 5px solid var(--cor-meta-diaria);
        }
        #modal-rastreio-metas h3 {
             color: var(--cor-meta-diaria);
        }
        #lista-dias-rastreio {
             max-height: 400px;
             overflow-y: auto;
             padding-right: 15px;
        }
        #lista-dias-rastreio p {
             padding: 12px 0;
             border-bottom: 1px dashed var(--cor-borda);
             display: flex;
             justify-content: space-between;
             align-items: center;
             font-size: 1em;
             font-family: var(--fonte-dados);
        }
        .status-batido {
             color: var(--cor-sucesso);
             font-weight: 700;
        }
        .status-pendente {
             color: var(--cor-divida);
             font-weight: 700;
        }
        
        /* =================================== */
        /* 7. TELA DE LOGIN (High Tech)        */
        /* =================================== */
        #login-screen {
            /* ... (Manter o estilo anterior, mas com o novo tema) */
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--cor-fundo-principal); 
            z-index: 2000;
        }

        .login-box {
            background-color: var(--cor-fundo-card);
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 400px;
            text-align: center;
            border-top: 5px solid var(--cor-primario);
            animation: fadeIn 0.5s ease-out;
            backdrop-filter: blur(5px);
        }
        
        .login-box h2 {
            font-size: 2em;
            margin-bottom: 35px;
            color: var(--cor-primario);
            font-family: var(--fonte-titulo);
            font-weight: 800;
            text-shadow: 0 0 8px rgba(0, 188, 212, 0.6);
        }
        
        /* ... (Resto do CSS de Login mantido, usando as novas vari√°veis) ... */

        /* 8. RESPONSIVIDADE (Ajustes para o novo layout) */
        @media (max-width: 768px) {
            .container {
                margin: 20px auto;
                padding: 0 15px; 
            }
            .valor {
                font-size: 2.5em; 
            }
            .meta-diaria-total span {
                 font-size: 3em;
            }
            .dashboard-header {
                grid-template-columns: 1fr; 
                gap: 25px;
            }
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            .btn-principal {
                width: 100%; 
            }
            
            /* Ocultar colunas menos essenciais em mobile */
            .tabela-transacoes th:nth-child(2), 
            .tabela-transacoes td:nth-child(2) {
                display: none; 
            }
            
            .contas-fixas-container ul {
                grid-template-columns: 1fr;
            }
            #plano-ia-controls {
                flex-direction: column;
                align-items: stretch;
            }
            #meses-plano {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    
    <div id="login-screen">
        <div class="login-box">
            <h2><i class="fas fa-fingerprint"></i> PROTOCOLO DE ACESSO (V2.0)</h2>
            <p style="color: var(--cor-texto-secundario); margin-bottom: 25px;">Acesso restrito ao Painel de Gest√£o Estrat√©gica.</p>
            <label for="password-input">CHAVE DE SEGURAN√áA (Senha)</label>
            <input type="password" id="password-input" placeholder="01" required>
            <button id="btn-login" class="btn-principal"><i class="fas fa-sign-in-alt"></i> AUTORIZAR ACESSO</button>
            <p id="login-feedback"></p>
        </div>
    </div>
    
    <div id="main-content" style="display: none;">
        
        <h1><i class="fas fa-cubes"></i> FINANCE PROTOCOL MANAGER</h1>

        <div class="container" id="data-atual-info">
            <button id="btn-data-atual">
                <i class="fas fa-calendar-day"></i> DATA/SISTEMA: <span id="data-atual"></span>
            </button>
        </div>

        <div class="motivacao-box container" id="motivacao-diaria">
            <i class="fas fa-infinity"></i>
            "DISCIPLINA √â O COMANDO. A LIBERDADE FINANCEIRA √â O STATUS. Mantenha o Foco."
        </div>
        
        <div id="meta-diaria-card" class="meta-diaria-total container">
            <p>TARGET DI√ÅRIO DE APORTE (FIXAS + QUITA√á√ÉO)</p>
            <span id="meta-diaria-total-el">R$ 0,00</span>
            <span id="meta-diaria-incentivo" class="destaque-conclusao" style="display: none;"></span>
        </div>
        

        <header class="dashboard-header container">
            
            <div class="info-card">
                <p class="rotulo"><i class="fas fa-satellite-dish"></i> CAPITAL ACUMULADO (ENTRADAS)</p>
                <span id="total-lancado" class="valor valor-caixa">R$ 0,00</span>
            </div>
            
            <div class="progress-area" id="meta-area">
                <p class="rotulo"><i class="fas fa-route"></i> STATUS DE QUITA√á√ÉO √öNICA</p>
                <p style="margin-bottom: 5px; color: var(--cor-texto-secundario);">D√≠vidas Pendentes: <span id="total-dividas-pendentes" style="font-weight: 700; color: var(--cor-divida); font-family: var(--fonte-dados);">R$ 0,00</span></p>
                <p>Progresso de Quita√ß√£o com Capital: <span id="progresso-capital-txt" style="font-weight: 700; color: var(--cor-sucesso); font-family: var(--fonte-dados);">0.00%</span></p>
                
                <div class="progresso-bar-container">
                    <div id="progresso-bar" class="progresso" style="width: 0%;"></div>
                </div>
            </div>
            
            <div class="info-card">
                <p class="rotulo"><i class="fas fa-skull-crossbones"></i> SALDO TOTAL A QUITAR</p>
                <span id="saldo-pendente-total" class="valor valor-divida">R$ 0,00</span>
            </div>
        </header>
        
        <main class="container">
            
            <div class="section-header">
                <h2><i class="fas fa-arrow-circle-up"></i> M√ìDULO: INJE√á√ÉO DE CAPITAL</h2>
                <button id="abrir-cadastro-receita" class="btn-principal"> <i class="fas fa-plus"></i> INJETAR VALOR</button>
            </div>

            
            <div id="historico-receitas-container" class="toggle-section">
                <div class="section-toggle receitas" id="toggle-receitas">
                    <h2><i class="fas fa-clipboard-list"></i> LOG: RECEITAS E RASTREIO DE METAS</h2>
                    <i class="fas fa-chevron-down"></i>
                </div>
                
                <div id="lista-receitas-container" class="lista-container-ocultavel" style="display: none;">
                    
                    <div id="filtro-receitas-batidas">
                         <p style="color: var(--cor-meta-diaria); font-weight: 600; font-family: var(--fonte-titulo); letter-spacing: 1px;">
                             <i class="fas fa-filter"></i> Rastrear Meta Di√°ria:
                         </p>
                         <button id="btn-filtro-tudo" class="ativo">TODOS OS REGISTROS</button>
                         <button id="btn-filtro-batido">SOMENTE METAS BATIDAS</button>
                    </div>
                    
                    <table class="tabela-transacoes">
                        <thead>
                            <tr>
                                <th>DESCRI√á√ÉO</th>
                                <th>VALOR (R$)</th>
                                <th>DATA</th>
                                <th>STATUS</th> 
                                <th>A√á√ÉO</th>
                            </tr>
                        </thead>
                        <tbody id="lista-entradas">
                            </tbody>
                    </table>
                </div>
            </div>
            
            <div id="feedback-fixas-quitadas" style="display: none;">
                 <i class="fas fa-medal"></i> PROTOCOLO DE CONTAS FIXAS CONCLU√çDO! <i class="fas fa-medal"></i>
                 <p>Contas Fixas liquidadas para este ciclo. Foco total em reduzir o Saldo Pendente.</p>
            </div>

            
            <div id="contas-fixas-card" class="contas-fixas-container">
                 <h3><i class="fas fa-calculator"></i> COMPONENTES FIXOS (Soma: R$ <span id="soma-fixas" class="valor-divida" style="font-family: var(--fonte-dados); font-size: 1em;">0,00</span>)</h3>
                 <ul id="lista-contas-fixas">
                     </ul>
            </div>

            
            <div id="dividas-container" class="toggle-section">
                <div class="section-toggle dividas" id="toggle-dividas">
                    <h2><i class="fas fa-radiation"></i> D√çVIDAS √öNICAS (PROTOCOLO DE REDU√á√ÉO)</h2>
                    <i class="fas fa-chevron-down"></i>
                </div>
                
                <div id="lista-dividas-quitar-container" class="lista-container-ocultavel" style="display: none;">
                    <table class="tabela-transacoes">
                        <thead>
                            <tr>
                                <th>CREDOR</th>
                                <th>VALOR INICIAL</th>
                                <th>SALDO ATUAL (R$)</th>
                                <th>A√á√ÉO</th>
                            </tr>
                        </thead>
                        <tbody id="lista-dividas-quitar">
                            </tbody>
                    </table>
                </div>
            </div>
            
            <div class="plano-quitacao">
                <h3><i class="fas fa-brain"></i> PLANO DE QUITA√á√ÉO ESTRAT√âGICO (M√ìDULO IA)</h3>
                
                <div id="plano-ia-controls">
                    <label for="meses-plano" style="margin-bottom: 0; color: var(--cor-texto-principal);">TARGET: Meses para Quitar D√≠vidas √öNICAS:</label>
                    <input type="number" id="meses-plano" value="5" min="1" max="60">
                    <button id="btn-gerar-plano" class="btn-principal">
                        <i class="fas fa-redo-alt"></i> RECALCULAR PLANO
                    </button>
                </div>
                
                <div id="resultado-plano-ia">
                    </div>
                
                <div id="dicas-quitacao">
                     </div>
            </div>
            
        </main>
    </div>


    <div id="modal-receita" class="modal">
        <div class="modal-content">
            <span class="fechar-modal" id="fechar-modal-receita">&times;</span>
            
            <h3 id="titulo-dados-receita"><i class="fas fa-arrow-up"></i> LAN√áAMENTO DE CAPITAL</h3>
            
            <label for="valor-input-receita">VALOR DO APORTE (R$)</label>
            <input type="number" id="valor-input-receita" placeholder="0.00" min="0.01" step="0.01">
            
            <button class="btn-ok" id="btn-cadastrar-receita">CONFIRMAR LAN√áAMENTO <i class="fas fa-check"></i></button>
        </div>
    </div>
    
    <div id="modal-quitacao" class="modal">
        <div class="modal-content">
            <span class="fechar-modal" id="fechar-modal-quitacao">&times;</span>
            
            <h3 id="titulo-quitacao" style="color: var(--cor-divida);"><i class="fas fa-receipt"></i> REGISTRAR PAGAMENTO</h3>
            
            <p style="margin-top: 15px; margin-bottom: 10px; font-family: var(--fonte-titulo); font-weight: 600; color: var(--cor-texto-secundario);">
                TARGET CREDOR: <span id="nome-credor" style="font-family: var(--fonte-dados); color: var(--cor-texto-principal);"></span>
            </p>
            <p style="margin-bottom: 20px; font-family: var(--fonte-titulo); font-weight: 600; color: var(--cor-texto-secundario);">
                SALDO PENDENTE: <span id="saldo-quitacao" class="saldo-divida" style="font-family: var(--fonte-dados);"></span>
            </p>

            <label for="valor-pagamento">VALOR DO PAGAMENTO (R$)</label>
            <input type="number" id="valor-pagamento" placeholder="0.00" min="0.01" step="0.01">
            
            <button class="btn-ok" id="btn-quitar-divida">FINALIZAR TRANSA√á√ÉO</button>
        </div>
    </div>
    
    <div id="modal-rastreio-metas" class="modal">
        <div class="modal-content">
            <span class="fechar-modal" id="fechar-modal-rastreio">&times;</span>
            
            <h3><i class="fas fa-check-square"></i> LOG DE RASTREIO DE METAS DI√ÅRIAS</h3>
            
            <div id="lista-dias-rastreio">
                <p>Carregando dados...</p>
            </div>
            
            <div style="clear: both;"></div> 
        </div>
    </div>
    
    <script>
        // O C√ìDIGO JAVASCRIPT COMPLETO DO PASSO ANTERIOR VAI AQUI.
        // Como a l√≥gica de neg√≥cio foi mantida, o JS √© o mesmo, exceto pelos seletores de CSS, 
        // que foram ajustados para as novas classes/IDs. (Por exemplo, na renderiza√ß√£o do filtro ativo).

        // APENAS AS FUN√á√ïES E VARI√ÅVEIS CHAVE FORAM REPETIDAS AQUI PARA MOSTRAR A CONEX√ÉO COM O NOVO DESIGN.

        // ===========================================
        // JAVASCRIPT: L√ìGICA DE NEG√ìCIO E CONEX√ÉO
        // ===========================================

        // 1. DADOS FIXOS E VARI√ÅVEIS GLOBAIS (AS MESMAS DO PASSO ANTERIOR)
        const DADOS_CONTAS_FIXAS = [
            { nome: "Aluguel", valor: 850.00 },
            { nome: "Carro", valor: 1800.00 },
            { nome: "Luz", valor: 250.00 },
            { nome: "Internet Movel", valor: 120.00 },
            { nome: "Wifi", valor: 100.00 },
            { nome: "Academia", valor: 300.00 } 
        ];
        
        const SOMA_CONTAS_FIXAS = DADOS_CONTAS_FIXAS.reduce((sum, item) => sum + item.valor, 0); 
        const DIAS_UTEIS_MES = 22; 
        const META_DIARIA_FIXAS = SOMA_CONTAS_FIXAS / DIAS_UTEIS_MES; 

        const DEBT_LIST_INITIAL = [
             // ... Lista de d√≠vidas (omitida para concis√£o, mas √© a mesma) ...
            { id: 1, credor: "Itau visa", valorInicial: 200.00, valorAtual: 200.00 },
            { id: 2, credor: "Banco Inter", valorInicial: 120.00, valorAtual: 120.00 },
            { id: 3, credor: "Conect car", valorInicial: 60.00, valorAtual: 60.00 },
            { id: 4, credor: "Vivo", valorInicial: 95.00, valorAtual: 95.00 },
            { id: 5, credor: "Banco Pan", valorInicial: 265.00, valorAtual: 265.00 },
            { id: 6, credor: "Karen", valorInicial: 300.00, valorAtual: 300.00 },
            { id: 7, credor: "Claro", valorInicial: 300.00, valorAtual: 300.00 },
            { id: 8, credor: "Bruno Carro", valorInicial: 400.00, valorAtual: 400.00 },
            { id: 9, credor: "Mercado pago", valorInicial: 522.00, valorAtual: 522.00 },
            { id: 10, credor: "Koin", valorInicial: 700.00, valorAtual: 700.00 },
            { id: 11, credor: "Will bank", valorInicial: 700.00, valorAtual: 700.00 },
            { id: 12, credor: "Picpay", valorInicial: 859.64, valorAtual: 859.64 },
            { id: 13, credor: "Carol", valorInicial: 1000.00, valorAtual: 1000.00 },
            { id: 14, credor: "Localiza", valorInicial: 1200.00, valorAtual: 1200.00 },
            { id: 15, credor: "Light", valorInicial: 1450.00, valorAtual: 1450.00 },
            { id: 16, credor: "Casa", valorInicial: 1650.00, valorAtual: 1650.00 },
            { id: 17, credor: "Bradesco", valorInicial: 2000.00, valorAtual: 2000.00 },
            { id: 18, credor: "Itau master", valorInicial: 2500.00, valorAtual: 2500.00 },
            { id: 19, credor: "Carro", valorInicial: 3500.00, valorAtual: 3500.00 },
            { id: 20, credor: "Ravi", valorInicial: 4570.00, valorAtual: 4570.00 },
        ].sort((a, b) => a.valorAtual - b.valorAtual); 

        
        let idDebtQuitting = null; 
        let filtroReceitas = 'TUDO'; 

        // Elementos DOM principais (MANTIDOS)
        const dataAtualEl = document.getElementById('data-atual');
        const metaDiariaCard = document.getElementById('meta-diaria-card');
        const metaDiariaTotalEl = document.getElementById('meta-diaria-total-el');
        const metaDiariaIncentivoEl = document.getElementById('meta-diaria-incentivo');
        const totalDividasPendentesEl = document.getElementById('total-dividas-pendentes'); 
        const progressoCapitalTxtEl = document.getElementById('progresso-capital-txt'); 
        const saldoPendenteTotalEl = document.getElementById('saldo-pendente-total');
        const contasFixasCard = document.getElementById('contas-fixas-card');
        const feedbackFixasQuitadasEl = document.getElementById('feedback-fixas-quitadas');
        const listaContasFixasEl = document.getElementById('lista-contas-fixas');
        const somaFixasEl = document.getElementById('soma-fixas');
        
        // Modais (MANTIDOS)
        const modalReceita = document.getElementById('modal-receita');
        const modalQuitacao = document.getElementById('modal-quitacao');
        const modalRastreioMetas = document.getElementById('modal-rastreio-metas'); 
        const valorInputReceita = document.getElementById('valor-input-receita');
        const btnCadastrarReceita = document.getElementById('btn-cadastrar-receita');
        const valorPagamentoInput = document.getElementById('valor-pagamento');
        const btnQuitarDivida = document.getElementById('btn-quitar-divida');
        const toggleDividasBtn = document.getElementById('toggle-dividas');
        const toggleReceitasBtn = document.getElementById('toggle-receitas');
        const listaDividasQuitarContainer = document.getElementById('lista-dividas-quitar-container');
        const listaReceitasContainer = document.getElementById('lista-receitas-container');
        
        // Login (MANTIDO)
        const LOGIN_PASSWORD = '01';

        // ... (As fun√ß√µes utilit√°rias e de l√≥gica 'carregarTransacoes', 'getTotais', 
        // 'getMetaDiariaAtingida', 'verificarEstadoContasFixas', etc., devem ser mantidas aqui) ...
        
        // ---------------------------------------------------------------------------------------------------------------------------------
        // FUN√á√ïES DE RENDERIZA√á√ÉO: AQUI OCORRERAM AJUSTES NO DOM PARA REFLETIR O NOVO DESIGN (Exemplo: Filtro de Bot√µes Ativos)
        // ---------------------------------------------------------------------------------------------------------------------------------
        
        const renderizarTabelas = (transacoes, dividas) => {
            const listaEntradasBody = document.getElementById('lista-entradas');
            const listaDividasBody = document.getElementById('lista-dividas-quitar');
            
            // ... (L√≥gica de getTotais, ordena√ß√£o e filtro) ...
            const { totalDividasPendentes } = getTotais(transacoes, dividas);
            const transacoesOrdenadas = transacoes.sort((a, b) => new Date(b.data) - new Date(a.data));
            let receitasParaExibir = transacoesOrdenadas;
            const receitasDiariasMap = getReceitasPorDia(transacoesOrdenadas); 
            
            // L√≥gica do Filtro
            const btnFiltroTudo = document.getElementById('btn-filtro-tudo');
            const btnFiltroBatido = document.getElementById('btn-filtro-batido');
            
            // Atualiza o estado visual do filtro
            btnFiltroTudo.classList.remove('ativo');
            btnFiltroBatido.classList.remove('ativo');
            
            if (filtroReceitas === 'BATIDO') {
                const datasBatidas = Object.keys(receitasDiariasMap).filter(data => {
                    const { atingido } = getMetaDiariaAtingida(transacoes, totalDividasPendentes, data);
                    return atingido;
                });
                
                receitasParaExibir = transacoesOrdenadas.filter(t => datasBatidas.includes(t.data));
                btnFiltroBatido.classList.add('ativo');

            } else {
                 btnFiltroTudo.classList.add('ativo');
            }
            
            // ... (Resto da renderiza√ß√£o de tabelas e listeners de quita√ß√£o/dele√ß√£o) ...
            // (O resto da fun√ß√£o `renderizarTabelas` e todas as outras fun√ß√µes de l√≥gica 
            // `initDashboard`, `handleLogin`, etc., s√£o as mesmas do passo anterior e devem ser inclu√≠das aqui).
             
             // --- Renderiza√ß√£o das Receitas ---
            listaEntradasBody.innerHTML = '';
            
            if (receitasParaExibir.length === 0) {
                 const mensagem = filtroReceitas === 'BATIDO' ? '<tr><td colspan="5" style="text-align: center; color: var(--cor-alerta);">Nenhum dia atingiu a Meta Di√°ria Total neste per√≠odo.</td></tr>' : '<tr><td colspan="5" style="text-align: center; color: var(--cor-texto-secundario);">Nenhuma receita lan√ßada no log.</td></tr>';
                 listaEntradasBody.innerHTML = mensagem;
            } else {
                receitasParaExibir.forEach((t, index) => {
                    const { atingido } = getMetaDiariaAtingida(transacoes, totalDividasPendentes, t.data);
                    
                    const statusHTML = atingido 
                        ? `<span style="color: var(--cor-sucesso); font-weight: 700;"><i class="fas fa-check"></i> BATIDO</span>` 
                        : `<span style="color: var(--cor-alerta); font-weight: 700;"><i class="fas fa-clock"></i> PENDENTE</span>`;
                        
                    const row = listaEntradasBody.insertRow();
                    row.innerHTML = `
                        <td>${t.descricao || 'Lan√ßamento R√°pido'}</td>
                        <td class="valor-caixa">${formatarMoeda(t.valor)}</td>
                        <td>${formatarData(t.data)}</td>
                        <td>${statusHTML}</td>
                        <td><button class="btn-acao-tabela deletar" data-index="${transacoesOrdenadas.indexOf(t)}"><i class="fas fa-trash"></i></button></td>
                    `;
                });
            }
            
            // --- Renderiza√ß√£o das D√≠vidas ---
            listaDividasBody.innerHTML = '';
            const dividasAtivas = dividas.filter(d => d.valorAtual > 0.01);
            
            if (dividasAtivas.length === 0) {
                 listaDividasBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--cor-sucesso); font-weight: bold;">üéâ PROTOCOL COMPLETE: Todas as d√≠vidas √∫nicas foram quitadas!</td></tr>';
            } else {
                dividasAtivas.forEach((d) => {
                    const row = listaDividasBody.insertRow();
                    row.innerHTML = `
                        <td>${d.credor}</td>
                        <td style="color: var(--cor-texto-secundario);">${formatarMoeda(d.valorInicial)}</td>
                        <td class="saldo-divida">${formatarMoeda(d.valorAtual)}</td>
                        <td>
                            <button class="btn-acao-tabela quitar" data-id="${d.id}">
                                <i class="fas fa-hand-holding-usd"></i> PAGAR
                            </button>
                        </td>
                    `;
                });
            }
        };

        // --- TODAS AS OUTRAS FUN√á√ïES DE L√ìGICA E LISTENERS DEVEM SER MANTIDAS INTACTAS AQUI ---
        // (Devido ao limite de espa√ßo, elas s√£o omitidas, mas s√£o id√™nticas √†s do passo anterior)
        // ... (colar o restante do JS aqui) ...
        
        // Fun√ß√£o de Quita√ß√£o e Inicializa√ß√£o (Replicada para garantir a ordem)
        const carregarTransacoes = () => {
            const transacoes = localStorage.getItem('transacoes') || '[]';
            return JSON.parse(transacoes);
        };

        const salvarTransacoes = (transacoes) => {
            localStorage.setItem('transacoes', JSON.stringify(transacoes));
        };
        
        const carregarDividas = () => {
            const dividas = localStorage.getItem('dividas');
            if (!dividas) {
                salvarDividas(DEBT_LIST_INITIAL);
                return DEBT_LIST_INITIAL;
            }
            const loadedDebts = JSON.parse(dividas);
            loadedDebts.sort((a, b) => a.valorAtual - b.valorAtual);
            return loadedDebts;
        }
        
        const salvarDividas = (dividas) => {
             dividas.sort((a, b) => a.valorAtual - b.valorAtual);
             localStorage.setItem('dividas', JSON.stringify(dividas));
        }

        const formatarMoeda = (valor) => {
            return parseFloat(valor).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        };

        const formatarData = (dataString) => {
            if (!dataString) return 'N/A';
            const [year, month, day] = dataString.split('-');
            return `${day}/${month}/${year}`;
        }
        
        const getHojeString = () => {
            return new Date().toISOString().slice(0, 10);
        }
        
        const getPrimeiroDiaDoMes = (data = new Date()) => {
            return new Date(data.getFullYear(), data.getMonth(), 1).toISOString().slice(0, 10);
        }
        
        const getReceitasPorDia = (transacoes) => {
             const receitasDiarias = {};
             transacoes.forEach(t => {
                 const data = t.data;
                 receitasDiarias[data] = (receitasDiarias[data] || 0) + parseFloat(t.valor);
             });
             return receitasDiarias;
        }

        const gerarPlanoQuitacaoIA = (isInit = false, totalDividasPendentes) => {
            const meses = parseInt(document.getElementById('meses-plano').value) || 5;
            
            if (totalDividasPendentes <= 0.01) {
                if (!isInit) {
                     document.getElementById('resultado-plano-ia').innerHTML = '<p style="color: var(--cor-sucesso); font-weight: bold; margin-top: 15px;">Protocolo de d√≠vida conclu√≠do. Foco em acumula√ß√£o de capital!</p>';
                }
                return 0;
            }

            const valorMensalNecessario = totalDividasPendentes / meses;
            const valorDiarioNecessario = valorMensalNecessario / 30; 
            const valorSemanalNecessario = valorDiarioNecessario * 7;

            if (!isInit) {
                 let html = `
                    <p style="margin-bottom: 15px; color: var(--cor-texto-secundario);">Para quitar **${formatarMoeda(totalDividasPendentes)}** em **${meses} meses**:</p>
                    <p><i class="fas fa-calendar-alt" style="color: var(--cor-primario);"></i> Aporte Mensal Necess√°rio: <strong>${formatarMoeda(valorMensalNecessario)}</strong></p>
                    <p><i class="fas fa-calendar-week" style="color: var(--cor-primario);"></i> Aporte Semanal Necess√°rio: <strong>${formatarMoeda(valorSemanalNecessario)}</strong></p>
                    <p><i class="fas fa-sun" style="color: var(--cor-primario);"></i> Aporte Di√°rio Necess√°rio: <strong>${formatarMoeda(valorDiarioNecessario)}</strong></p>
                 `;
                 document.getElementById('resultado-plano-ia').innerHTML = html;
            }
            
            return valorDiarioNecessario; 
        };
        
        const getMetaDiariaAtingida = (transacoes, totalDividasPendentes, dataAlvo = getHojeString()) => {
            const receitasDiarias = getReceitasPorDia(transacoes);
            
            const metaQuitacaoDiaria = gerarPlanoQuitacaoIA(true, totalDividasPendentes); 
            const metaTotalDiaria = META_DIARIA_FIXAS + metaQuitacaoDiaria;
            
            const recebidoNaData = receitasDiarias[dataAlvo] || 0;
            
            return {
                metaTotal: metaTotalDiaria,
                atingido: recebidoNaData >= metaTotalDiaria - 0.01,
                recebido: recebidoNaData
            };
        }
        
        const getTotais = (transacoes, dividas) => {
            let totalReceitas = 0;
            transacoes.forEach(t => totalReceitas += parseFloat(t.valor));

            let totalDividasIniciais = DEBT_LIST_INITIAL.reduce((sum, d) => sum + d.valorInicial, 0);
            let totalDividasPendentes = 0;
            dividas.filter(d => d.valorAtual > 0.01).forEach(d => totalDividasPendentes += parseFloat(d.valorAtual));
            
            const progressoCapital = totalDividasIniciais > 0.01 
                ? (totalReceitas / totalDividasIniciais) * 100 
                : (totalReceitas > 0 ? 100 : 0);
            
            const excedenteReceitas = Math.max(0, totalReceitas - SOMA_CONTAS_FIXAS); 
            const saldoPendenteTotal = totalDividasPendentes; 

            return { totalReceitas, totalDividasIniciais, totalDividasPendentes, progressoCapital, excedenteReceitas, saldoPendenteTotal };
        }
        
        const verificarEstadoContasFixas = (totalReceitas) => {
             const hoje = getHojeString();
             const primeiroDiaMes = getPrimeiroDiaDoMes();
             const fixasQuitadasEm = localStorage.getItem('fixasQuitadasEm');
             const metaFixasAtingida = totalReceitas >= SOMA_CONTAS_FIXAS - 0.01;
             
             let deveMostrar = true;
             
             if (fixasQuitadasEm && fixasQuitadasEm >= primeiroDiaMes) {
                 deveMostrar = false;
             } 
             
             if (metaFixasAtingida && (!fixasQuitadasEm || fixasQuitadasEm < primeiroDiaMes)) {
                 localStorage.setItem('fixasQuitadasEm', hoje);
                 deveMostrar = false;
             }
             
             if (hoje === primeiroDiaMes) {
                 const mesAtual = new Date(hoje).getMonth();
                 const mesQuited = fixasQuitadasEm ? new Date(fixasQuitadasEm).getMonth() : -1;
                 
                 if(mesQuited !== mesAtual && mesAtual > mesQuited) {
                      localStorage.removeItem('fixasQuitadasEm');
                      deveMostrar = true; 
                 }
             }

             contasFixasCard.style.display = deveMostrar ? 'block' : 'none';
             feedbackFixasQuitadasEl.style.display = deveMostrar ? 'none' : 'block';
        }


        const atualizarDashboard = (transacoes, dividas) => {
            const { totalReceitas, totalDividasPendentes, progressoCapital, saldoPendenteTotal } = getTotais(transacoes, dividas);

            dataAtualEl.textContent = new Date().toLocaleDateString('pt-BR');
            somaFixasEl.textContent = formatarMoeda(SOMA_CONTAS_FIXAS).replace('R$', '').trim(); 

            document.getElementById('total-lancado').textContent = formatarMoeda(totalReceitas);
            saldoPendenteTotalEl.textContent = formatarMoeda(saldoPendenteTotal);
            
            totalDividasPendentesEl.textContent = formatarMoeda(totalDividasPendentes);
            
            const progressoExibido = Math.min(100, progressoCapital).toFixed(2);
            progressoCapitalTxtEl.textContent = `${progressoExibido}%`;

            const progressoBar = document.getElementById('progresso-bar');
            progressoBar.style.width = `${progressoExibido}%`;
            
            verificarEstadoContasFixas(totalReceitas);
        };
        
        const renderizarMetaDiaria = (transacoes, totalDividasPendentes) => {
            const { metaTotal, atingido, recebido } = getMetaDiariaAtingida(transacoes, totalDividasPendentes);

            metaDiariaTotalEl.textContent = formatarMoeda(metaTotal);

            if (atingido) {
                metaDiariaCard.classList.add('meta-diaria-concluida');
                metaDiariaIncentivoEl.innerHTML = `<i class="fas fa-check-circle"></i> TARGET CONCLU√çDO! (APORTE: ${formatarMoeda(recebido)})`;
                metaDiariaIncentivoEl.style.display = 'block';
            } else {
                metaDiariaCard.classList.remove('meta-diaria-concluida');
                const falta = Math.max(0, metaTotal - recebido);
                metaDiariaIncentivoEl.innerHTML = `<i class="fas fa-arrow-up"></i> FALTAM ${formatarMoeda(falta)} PARA ATINGIR O TARGET DE HOJE.`;
                metaDiariaIncentivoEl.style.display = 'block';
            }
        }
        
        const renderizarContasFixas = () => {
            listaContasFixasEl.innerHTML = '';
            
            let html = `
                <li>TARGET DI√ÅRIO (FIXAS / 22 dias): <span class="diaria-fixa-destaque">${formatarMoeda(META_DIARIA_FIXAS)}</span></li>
                <li>TOTAL GERAL FIXAS M√äS: <span style="color: var(--cor-sucesso);">${formatarMoeda(SOMA_CONTAS_FIXAS)}</span></li>
            `;
            
            DADOS_CONTAS_FIXAS.forEach(conta => {
                 html += `<li>${conta.nome}: <span>${formatarMoeda(conta.valor)}</span></li>`;
            });
            
            listaContasFixasEl.innerHTML = html;
        }

        const renderizarRastreioMetas = (transacoes, totalDividasPendentes) => {
            const listaDiasRastreio = document.getElementById('lista-dias-rastreio');
            const receitasDiariasMap = getReceitasPorDia(transacoes);
            const datasRegistradas = Object.keys(receitasDiariasMap).sort((a, b) => new Date(b) - new Date(a));
            
            if (datasRegistradas.length === 0) {
                 listaDiasRastreio.innerHTML = '<p style="text-align: center; color: var(--cor-texto-secundario);">Nenhum lan√ßamento de receita registrado.</p>';
                 return;
            }
            
            let html = '';
            datasRegistradas.forEach(data => {
                const { metaTotal, atingido, recebido } = getMetaDiariaAtingida(transacoes, totalDividasPendentes, data);
                const statusClasse = atingido ? 'status-batido' : 'status-pendente';
                const statusIcone = atingido ? 'fas fa-check-circle' : 'fas fa-times-circle';
                
                html += `
                    <p>
                        <span><i class="${statusIcone}" style="margin-right: 10px;"></i> ${formatarData(data)}</span>
                        <span class="${statusClasse}">
                            ${atingido ? 'META BATIDA' : 'PENDENTE'}
                            (${formatarMoeda(recebido)} / ${formatarMoeda(metaTotal)})
                        </span>
                    </p>
                `;
            });
            
            listaDiasRastreio.innerHTML = html;
        }
        
        const renderizarDicasQuitacao = (dividas) => {
             const dividasAtivas = dividas.filter(d => d.valorAtual > 0.01);
             const dicasEl = document.getElementById('dicas-quitacao');
             
             if (dividasAtivas.length === 0) {
                 dicasEl.innerHTML = '<h4>ESTRAT√âGIA DE CAPITAL</h4><p style="color: var(--cor-sucesso);">Nenhuma d√≠vida a rastrear. Mantenha o foco em acumula√ß√£o de capital e investimentos.</p>';
                 return;
             }
             
             let html = `
                 <h4>ESTRAT√âGIA: BOLA DE NEVE (MENOR PARA MAIOR)</h4>
                 <p style="font-size: 0.9em; margin-bottom: 10px; color: var(--cor-texto-secundario);">
                    Priorize as menores d√≠vidas para criar impulso r√°pido no protocolo de quita√ß√£o.
                 </p>
                 <ul>
             `;
             
             dividasAtivas.slice(0, 3).forEach((d, index) => {
                 html += `<li>**PRIORIDADE ${index + 1}:** ${d.credor} (Saldo: ${formatarMoeda(d.valorAtual)})</li>`;
             });
             
             html += `
                 </ul>
                 <p style="font-size: 0.85em; margin-top: 15px; color: var(--cor-alerta);">
                    *A√ß√£o: Direcione todo o excedente para a d√≠vida **PRIORIDADE 1**.*
                 </p>
             `;
             dicasEl.innerHTML = html;
        }


        const initDashboard = () => {
            const transacoes = carregarTransacoes();
            const dividas = carregarDividas();
            const { totalDividasPendentes } = getTotais(transacoes, dividas);
            
            atualizarDashboard(transacoes, dividas);
            renderizarContasFixas(); 
            renderizarTabelas(transacoes, dividas);
            
            gerarPlanoQuitacaoIA(false, totalDividasPendentes); 
            renderizarMetaDiaria(transacoes, totalDividasPendentes);
            
            renderizarDicasQuitacao(dividas); 
        };
        
        const handleLogin = () => {
            const passwordInput = document.getElementById('password-input').value;
            const loginFeedback = document.getElementById('login-feedback');
            
            if (passwordInput === LOGIN_PASSWORD) {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                localStorage.setItem('loggedIn', 'true');
                initDashboard();
            } else {
                loginFeedback.textContent = 'ERRO: CHAVE DE SEGURAN√áA INV√ÅLIDA.';
                document.getElementById('password-input').value = '';
                document.getElementById('password-input').focus();
            }
        };
        
        const fecharModal = (modalEl) => {
            modalEl.style.display = 'none';
        };
        
        const toggleSection = (container, button) => {
            const isOculta = container.style.display === 'none';
            
            if (isOculta) {
                container.style.display = 'block';
                button.classList.add('aberto');
            } else {
                container.style.display = 'none';
                button.classList.remove('aberto');
            }
        };
        
        const adicionarReceita = () => {
            const valor = parseFloat(valorInputReceita.value);

            if (isNaN(valor) || valor <= 0) {
                alert("ERRO: Valor de aporte inv√°lido. Insira um valor positivo.");
                return;
            }

            const novaTransacao = {
                tipo: 'CAIXA',
                valor: valor.toFixed(2), 
                descricao: 'Lan√ßamento R√°pido',
                data: getHojeString()
            };

            let transacoes = carregarTransacoes();
            transacoes.push(novaTransacao);
            salvarTransacoes(transacoes);
            
            initDashboard(); 
            fecharModal(modalReceita);
        };
        
        const iniciarQuitarDivida = (id) => {
            const dividas = carregarDividas();
            const divida = dividas.find(d => d.id === id); 
            
            if (!divida || divida.valorAtual <= 0.01) {
                alert("STATUS: D√≠vida j√° quitada.");
                return;
            }
            
            idDebtQuitting = id;
            document.getElementById('nome-credor').textContent = divida.credor;
            document.getElementById('saldo-quitacao').textContent = formatarMoeda(divida.valorAtual);
            valorPagamentoInput.value = divida.valorAtual.toFixed(2);
            valorPagamentoInput.focus();
            
            modalQuitacao.style.display = 'block';
        }
        
        const registrarPagamento = () => {
            const valorPagamento = parseFloat(valorPagamentoInput.value);
            const dividas = carregarDividas();
            let divida = dividas.find(d => d.id === idDebtQuitting);
            
            if (isNaN(valorPagamento) || valorPagamento <= 0) {
                alert("ERRO: Insira um valor de pagamento v√°lido e positivo.");
                return;
            }
            
            if (!divida) {
                alert("ERRO: D√≠vida n√£o encontrada no registro.");
                return;
            }
            
            let valorEfetivo = valorPagamento;
            if (valorPagamento > divida.valorAtual + 0.01) {
                 if (!confirm(`O valor de ${formatarMoeda(valorPagamento)} √© maior que o saldo pendente de ${formatarMoeda(divida.valorAtual)}. Deseja aplicar o pagamento total (${formatarMoeda(divida.valorAtual)}) e concluir a d√≠vida?`)) {
                    return;
                }
                valorEfetivo = divida.valorAtual;
            } 
            
            divida.valorAtual = divida.valorAtual - valorEfetivo;
            
            if (divida.valorAtual < 0.01) {
                divida.valorAtual = 0;
                alert(`üéâ SUCESSO! D√≠vida com ${divida.credor} quitada!`);
            }
            
            salvarDividas(dividas);
            initDashboard();
            fecharModal(modalQuitacao);
        }
        
        const deletarReceita = (index) => {
             if (!confirm("ALERTA: Confirme a exclus√£o do registro de receita. Esta a√ß√£o √© irrevers√≠vel.")) {
                return;
            }
            
            let transacoes = carregarTransacoes();
            transacoes.splice(index, 1); 
            
            salvarTransacoes(transacoes);
            initDashboard(); 
        };

        
        // Listeners
        document.getElementById('btn-login').addEventListener('click', handleLogin);
        document.getElementById('password-input').addEventListener('keypress', (e) => {
             if (e.key === 'Enter') {
                 handleLogin();
             }
        });
        
        document.addEventListener('DOMContentLoaded', () => {
             if (localStorage.getItem('loggedIn') === 'true') {
                 document.getElementById('login-screen').style.display = 'none';
                 document.getElementById('main-content').style.display = 'block';
                 initDashboard();
             } else {
                 document.getElementById('login-screen').style.display = 'flex';
             }
        });
        
        document.getElementById('btn-data-atual').addEventListener('click', () => {
             const transacoes = carregarTransacoes();
             const dividas = carregarDividas();
             const { totalDividasPendentes } = getTotais(transacoes, dividas);
             
             renderizarRastreioMetas(transacoes, totalDividasPendentes); 
             modalRastreioMetas.style.display = 'block';
        });


        document.getElementById('abrir-cadastro-receita').addEventListener('click', () => {
            valorInputReceita.value = '';
            modalReceita.style.display = 'block';
            valorInputReceita.focus();
        });
        document.getElementById('fechar-modal-receita').addEventListener('click', () => fecharModal(modalReceita));
        btnCadastrarReceita.addEventListener('click', adicionarReceita); 
        
        document.getElementById('fechar-modal-quitacao').addEventListener('click', () => fecharModal(modalQuitacao));
        btnQuitarDivida.addEventListener('click', registrarPagamento);
        
        document.getElementById('fechar-modal-rastreio').addEventListener('click', () => fecharModal(modalRastreioMetas)); 

        document.getElementById('btn-gerar-plano').addEventListener('click', () => {
            const { totalDividasPendentes } = getTotais(carregarTransacoes(), carregarDividas());
            gerarPlanoQuitacaoIA(false, totalDividasPendentes); 
            renderizarMetaDiaria(carregarTransacoes(), totalDividasPendentes); 
        });

        toggleDividasBtn.addEventListener('click', () => toggleSection(listaDividasQuitarContainer, toggleDividasBtn));
        toggleReceitasBtn.addEventListener('click', () => toggleSection(listaReceitasContainer, toggleReceitasBtn));
        
        document.getElementById('btn-filtro-tudo').addEventListener('click', () => {
            filtroReceitas = 'TUDO';
            renderizarTabelas(carregarTransacoes(), carregarDividas());
        });
        document.getElementById('btn-filtro-batido').addEventListener('click', () => {
            filtroReceitas = 'BATIDO';
            renderizarTabelas(carregarTransacoes(), carregarDividas());
        });
        
        document.addEventListener('click', (e) => {
            if (e.target.closest('.btn-acao-tabela.deletar')) {
                const index = e.target.closest('.btn-acao-tabela.deletar').getAttribute('data-index');
                deletarReceita(parseInt(index));
            }
            
            if (e.target.closest('.btn-acao-tabela.quitar')) {
                const id = parseInt(e.target.closest('.btn-acao-tabela.quitar').getAttribute('data-id'));
                iniciarQuitarDivida(id);
            }
        });

        window.addEventListener('click', (event) => {
            if (event.target === modalReceita) {
                fecharModal(modalReceita);
            }
            if (event.target === modalQuitacao) {
                fecharModal(modalQuitacao);
            }
            if (event.target === modalRastreioMetas) { 
                fecharModal(modalRastreioMetas);
            }
        });

    </script>
</body>
</html>
